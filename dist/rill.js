!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).rill=e()}}(function(){return function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return o(r||e)},f,f.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t){"use strict";function r(e,t){for(var n,o=e.length,i=0;i<o;i++)if(n=e[i])if("function"==typeof n)t.push(n);else if(Array.isArray(n))r(n,t);else{if(!Array.isArray(n.stack))throw new TypeError("Rill: Invalid middleware provided. Got a ["+n.constructor.name+"].");r(n.stack,t)}return t}t.exports=function(e){if(!Array.isArray(e))throw new TypeError("Rill: Middleware stack must be an array.");var t=r(e,[]);return function(e,r){function n(i){if(i<=o)return Promise.reject(new Error("Rill: next() called multiple times."));var s=t[i]||r;if(o=i,!s)return Promise.resolve();try{return Promise.resolve(s(e,function(){return n(i+1)}))}catch(e){return Promise.reject(e)}}var o=-1;return n(0)}}},{}],2:[function(e,t){"use strict";function r(e,t,n){if("number"!=typeof e)throw new TypeError("Rill#HttpError.fail: Status code must be a number.");this.name="HttpError",this.code=e,this.message=t||o[e];for(var i in n)this[i]=n[i];Error.captureStackTrace?Error.captureStackTrace(this,r):Error.call(this)}function n(e,t,n){throw new r(e,t,n)}var o=e(5).STATUS_CODES;r.prototype=new Error,r.fail=n,r.assert=function(e,t,r,o){e||n(t,r,o)},t.exports=r},{5:5}],3:[function(e,t,r){"use strict";function n(){l.addEventListener("popstate",this._onHistory),l.addEventListener("submit",this._onSubmit),l.addEventListener("click",this._onClick),this.prependListener("request",i),this._pending_load=this._initialize&&setTimeout(this._onHistory,0)}function o(){l.removeEventListener("popstate",this._onHistory),l.removeEventListener("submit",this._onSubmit),l.removeEventListener("click",this._onClick),this.removeListener("request",i),clearTimeout(this._pending_load),clearTimeout(this._pending_refresh)}function i(e,t){e.headers.referer=e.headers.referer||e.socket.server._referrer,t.once("finish",s.bind(null,e,t))}function s(e,t){var r=e._options.parsed,n=e.socket.server;clearTimeout(n._pending_refresh);var o=t.getHeader("set-cookie");if(o&&o.length)if("string"==typeof o)b.cookie=o;else for(var i=0;i<o.length;i++)b.cookie=o[i];var s=t.getHeader("refresh");if(s){var a=s.split(" url="),u=1e3*parseInt(a[0],10),c=a[1];n._pending_refresh=setTimeout(f.bind(null,n,{url:c}),u)}if("GET"===e.method&&!t.getHeader("location")){if(!1!==e._scroll)if(""===r.hash)l.scrollTo(0,0);else{var p=b.getElementById(r.hash.slice(1));p&&p.scrollIntoView&&p.scrollIntoView({block:"start",behavior:m.pathname===r.pathname&&(m.search||"")===(r.search||"")?"smooth":"auto"})}e.headers.referer!==r.href&&(n._referrer=r.href,!1!==e._history&&g.pushState(null,b.title,e.url))}}function a(){f(this,{url:m.href,scroll:!1,history:!1})}function u(e){if(!e.defaultPrevented){var t=e.target,r=t.action||t.getAttribute("action")||"",n=p.parse(r,m.href);t.target&&"_self"!==t.target||n.host===m.host&&n.protocol===m.protocol&&(e.preventDefault(),f(this,{url:r,method:t.method||t.getAttribute("method"),form:t}),t.hasAttribute("data-noreset")||t.reset())}}function c(e){if(!(e.defaultPrevented||e.button||e.metaKey||e.ctrlKey||e.shiftKey)){for(var t=e.target;null!=t&&"A"!==t.nodeName;)t=t.parentNode;t&&t.href&&(t.target&&"_self"!==t.target||t.rel&&"external"===t.rel||t.hasAttribute("download")||t.host&&t.host!==m.host||t.protocol&&":"!==t.protocol&&t.protocol!==m.protocol||(e.preventDefault(),f(this,t.href)))}}function f(e,t,r){if("object"==typeof t?r=t:"string"==typeof t&&((r=r||{}).url=t),!r||"string"!=typeof r.url)return Promise.reject(new TypeError("@rill/http/adapter/browser#fetch: url must be a string."));var n=r.parsed=p.parse(r.url,m.href);return new Promise(function(t){var o=y._createIncomingMessage(e,r),i=v._createServerResponse(o),s=r.form;if(s){o.headers["content-type"]=s.enctype||s.getAttribute("enctype")||"application/x-www-form-urlencoded";var a=h(s);r.body=a.body,r.files=a.files}if("GET"===o.method){var u=r.query||r.body;u&&(n=r.parsed=p.parse(n.pathname+"?"+d.stringify(u,!0)+n.hash,m.href))}else o.body=r.body,o.files=r.files;o._scroll=r.scroll,o._history=r.history,o.url=n.pathname+n.search+n.hash,i.once("finish",function(){o.complete=!0,o.emit("end");var n=i.getHeader("location");return t(!n||void 0!==r.redirect&&"follow"!==r.redirect?[i._body,{url:o.url,headers:i.getHeaders(),status:i.statusCode,statusText:i.statusMessage}]:f(e,{url:n,history:r.history,scroll:r.scroll}))}),setTimeout(e.emit.bind(e,"request",o,i),0)})}var l=e(16),p=e(21),h=e(24),d=e(20),m=e(15)(),y=e(4),v=e(6),g=l.history,b=l.document;r.fetch=f,r.attach=function(e,t){return e._referrer=b&&b.referrer,e._initialize=!1!==t,e._pending_refresh=null,e._onHistory=a.bind(e),e._onSubmit=u.bind(e),e._onClick=c.bind(e),e.prependListener("listening",n),e.prependListener("close",o),e}},{15:15,16:16,20:20,21:21,24:24,4:4,6:6}],4:[function(e,t){"use strict";function r(e){this.headers={},this.socket=this.connection=e}function n(e){if(null==e||"function"!=typeof e.forEach)return e;var t={};return e.forEach(function(e,r){t[r]=e}),t}var o=e(14);r._createIncomingMessage=function(e,t){var o=t.parsed,i=new r({server:e,remoteAddress:"127.0.0.1",encrypted:"https:"===o.protocol}),s=i.headers;s.referer=s.referer||s.referrer,s.date=(new Date).toUTCString(),s.host=o.host,s.cookie=document.cookie,s["user-agent"]=navigator.userAgent,s["accept-language"]=navigator.language,s.connection="keep-alive",s["cache-control"]="max-age=0",s.accept="*/*";var a=n(t.headers);for(var u in a)s[u]=a[u];return i.method=t.method?t.method.toUpperCase():"GET",i._options=t,i},t.exports=r.default=r,r.prototype=Object.create(o.prototype),r.prototype.httpVersionMajor=1,r.prototype.httpVersionMinor=1,r.prototype.httpVersion=r.prototype.httpVersionMajor+"."+r.prototype.httpVersionMinor,r.prototype.complete=!1,r.prototype.url="",r.prototype.headers={},r.prototype.method="GET"},{14:14}],5:[function(e,t,r){"use strict";var n=e(7),o=e(4),i=e(6),s=e(28);r.STATUS_CODES=s,r.METHODS=["OPTIONS","HEAD","GET","PUT","POST","PATCH","DELETE"],r.Server=n,r.IncomingMessage=o,r.ServerResponse=i,r.createServer=function(){var e=arguments[arguments.length-1];return new n(e)}},{28:28,4:4,6:6,7:7}],6:[function(e,t){"use strict";function r(e){this._headers={},this.socket=this.connection=e.socket}var n=e(14),o=e(28);r._createServerResponse=function(e){var t=new r(e);return t._body=[],t},t.exports=r.default=r,r.prototype=Object.create(n.prototype),r.prototype.statusCode=null,r.prototype.statusMessage=null,r.prototype.sendDate=!0,r.prototype.finished=!1,r.prototype.headersSent=!1,r.prototype.writeContinue=r.prototype.setTimeout=r.prototype.addTrailers=function(){},r.prototype.write=function(e,t,r){this._body.push(e),"function"==typeof t&&(r=t,t=null),"function"==typeof r&&this.once("finish",r)},r.prototype.writeHead=function(e,t,r){if(!this.finished&&(this.statusCode=e,this.headersSent=!0,t&&("object"==typeof t?r=t:this.statusMessage=t),"object"==typeof r))for(var n in r)this.setHeader(n,r[n])},r.prototype.getHeaders=function(){var e={};for(var t in this._headers)e[t]=this._headers[t];return e},r.prototype.getHeaderNames=function(){return Object.keys(this._headers)},r.prototype.getHeader=function(e){return this._headers[e.toLowerCase()]},r.prototype.hasHeader=function(e){return e.toLowerCase()in this._headers},r.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},r.prototype.setHeader=function(e,t){this._headers[e.toLowerCase()]=t},r.prototype.end=function(e,t,r){this.finished||("function"==typeof e?(r=e,e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this._body.push(e),"function"==typeof r&&this.once("finish",r),null==this.statusCode&&(this.statusCode=200),null==this.statusMessage&&(this.statusMessage=o[this.statusCode]),this.sendDate&&(this._headers.date=(new Date).toUTCString()),this._headers.status=this.statusCode,this.headersSent=!0,this.finished=!0,this.emit("finish"))}},{14:14,28:28}],7:[function(e,t){"use strict";function r(e){e&&this.on("request",e)}var n=e(14);t.exports=r.default=r,(r.prototype=Object.create(n.prototype)).listen=function(){var e=arguments[arguments.length-1];return"function"==typeof e&&this.once("listening",e),setTimeout(function(){this.listening=!0,this.emit("listening")}.bind(this),0),this},r.prototype.close=function(e){return"function"==typeof e&&this.once("close",e),setTimeout(function(){this.listening=!1,this.emit("close")}.bind(this),0),this}},{14:14}],8:[function(e,t){"use strict";t.exports=e(5)},{5:5}],9:[function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function s(){m&&h&&(m=!1,h.length?d=h.concat(d):y=-1,d.length&&a())}function a(){if(!m){var e=o(s);m=!0;for(var t=d.length;t;){for(h=d,d=[];++y<t;)h&&h[y].run();y=-1,t=d.length}h=null,m=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var f,l,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(e){f=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var h,d=[],m=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new u(e,t)),1!==d.length||m||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(){return[]},p.binding=function(){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],10:[function(e,t){"use strict";t.exports=function(e){var t,r;if(!e)return 0;for(t=r=(e=e.toString()).length;t--;){var n=e[t].charCodeAt();56320<=n&&n<=57343&&t--,127<n&&n<=2047?r++:2047<n&&n<=65535&&(r+=2)}return r}},{}],11:[function(e,t){"use strict";function r(e){if("function"==typeof e.toJSON||e.constructor===Object||e.constructor===Array)return!0;try{return JSON.stringify(e),!0}catch(e){return!1}}var n=/^\s*</,o=e(18),i=e(12).lookup,s=o.buffer,a=o.stream;t.exports=function(e){if(null!=e&&"function"!=typeof e){if("object"==typeof e){if(s(e))return"application/octet-stream";if(a(e))return i(e.path)||"application/octet-stream";if(r(e))return"application/json; charset=UTF-8"}return"text/"+(n.test(String(e))?"html":"plain")+"; charset=UTF-8"}}},{12:12,18:18}],12:[function(e,t){"use strict";t.exports={lookup:function(){}}},{}],13:[function(e,t,r){"use strict";function n(e,t){try{return t(e)}catch(t){return e}}r.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var r={},i=t||{},a=e.split(s),u=i.decode||o,c=0;c<a.length;c++){var f=a[c],l=f.indexOf("=");if(!(l<0)){var p=f.substr(0,l).trim(),h=f.substr(++l,f.length).trim();'"'==h[0]&&(h=h.slice(1,-1)),void 0==r[p]&&(r[p]=n(h,u))}}return r},r.serialize=function(e,t,r){var n=r||{},o=n.encode||i;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!a.test(e))throw new TypeError("argument name is invalid");var s=o(t);if(s&&!a.test(s))throw new TypeError("argument val is invalid");var u=e+"="+s;if(null!=n.maxAge){var c=n.maxAge-0;if(isNaN(c))throw new Error("maxAge should be a Number");u+="; Max-Age="+Math.floor(c)}if(n.domain){if(!a.test(n.domain))throw new TypeError("option domain is invalid");u+="; Domain="+n.domain}if(n.path){if(!a.test(n.path))throw new TypeError("option path is invalid");u+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");u+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(u+="; HttpOnly"),n.secure&&(u+="; Secure"),n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"strict":u+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}return u};var o=decodeURIComponent,i=encodeURIComponent,s=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},{}],14:[function(e,t){function r(e){return"function"==typeof e}function n(e){if(!r(e))throw TypeError("Invalid listener")}function o(e,t,r){switch(r.length){case 1:t.call(e);break;case 2:t.call(e,r[1]);break;case 3:t.call(e,r[1],r[2]);break;default:t.apply(e,a.call(r,1))}}function i(e,t,o,i){n(o);var s=e.$e||(e.$e={}),a=s[t];return a?r(a)?s[t]=i?[o,a]:[a,o]:i?a.unshift(o):a.push(o):s[t]=o,e}function s(){this.$e=this.$e||{}}var a=Array.prototype.slice;s.EventEmitter=s,s.prototype={$e:null,emit:function(e){var t=arguments,n=this.$e;if(n){var i=n&&n[e];if(!i){if("error"===e){var s=t[1];if(!(s instanceof Error)){var u=s;(s=new Error("Error: "+u)).context=u}throw s}return!1}if(r(i))o(this,i,t);else for(var c=0,f=(i=a.call(i)).length;c<f;c++)o(this,i[c],t);return!0}},on:function(e,t){return i(this,e,t,!1)},prependListener:function(e,t){return i(this,e,t,!0)},once:function(e,t){function r(){this.removeListener(e,r),t&&(t.apply(this,arguments),t=null)}return n(t),this.on(e,r),this},removeListener:function(e,t){n(t);var o,i=this.$e;if(i&&(o=i[e]))if(r(o))o===t&&delete i[e];else for(var s=o.length-1;s>=0;s--)o[s]===t&&o.splice(s,1);return this},removeAllListeners:function(e){var t=this.$e;t&&delete t[e]},listenerCount:function(e){var t=this.$e,n=t&&t[e];return n?r(n)?1:n.length:0}},t.exports=s},{}],15:[function(e,t){"use strict";var r=e(16);t.exports=function(){return r.history&&r.history.location||r.location||{href:""}}},{16:16}],16:[function(e,t){(function(e){var r;r="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t){"use strict";t.exports=function(e){if("string"!=typeof e)throw new TypeError("Header Fields must be strings.");return"referrer"===(e=e.toLowerCase())&&(e="referer"),e}},{}],18:[function(e,t){"use strict";function r(e){var t=e.toLowerCase();return function(e){var r=typeof e;switch(r){case"object":case"function":return n.call(e)===o[t];default:return r===t}}}var n=Object.prototype.toString,o={string:"[object String]",number:"[object Number]",boolean:"[object Boolean]",date:"[object Date]",regexp:"[object RegExp]",error:"[object Error]",function:"[object Function]",arguments:"[object Arguments]",object:"[object Object]",array:"[object Array]"};t.exports={string:r("String"),number:r("Number"),boolean:r("Boolean"),date:r("Date"),regexp:r("RegExp"),error:r("Error"),function:r("Function"),arguments:r("Arguments"),object:r("Object"),array:r("Array"),stream:function(e){return null!=e&&"function"==typeof e.pipe},buffer:function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer},empty:function(e){for(var t in e)return!1;return!0}}},{}],19:[function(e,t){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],20:[function(e,t,r){"use strict";var n=/([^=?&]+)=?([^&]*)/g,o=e(26),i=e(27);r.stringify=function(e,t){t&&(e=o(e));var r=Object.keys(e);if(!r.length)return"";for(var n,i=0,s=r.length;i<s;i++)n=r[i],r[i]=encodeURIComponent(n)+"="+encodeURIComponent(e[n]);return r.join("&")},r.parse=function(e,t){for(var r,o=t?i:i.flat,s={};r=n.exec(e);)o(s,decodeURIComponent(r[1]),decodeURIComponent(r[2]));return s}},{26:26,27:27}],21:[function(e,t,r){"use strict";var n=e(22),o=e(23),i="~#~",s={};r.parts=o,r.cache=s,r.parse=function(e,t){var r=e+i+t,a=s[r];if(!a){var u=t?new n(e,t):new n(e);a={};for(var c,f,l=o.length;l--;)null==(f=u[c=o[l]])&&(f=""),a[c]=f;a=s[r]=Object.freeze(a)}return a},r.stringify=function(e){if("object"!=typeof e||null==e)throw new TypeError("URL must be an object.");return(e.protocol?e.protocol+"//":"")+(e.host||(e.hostname||"")+(e.port?":"+e.port:""))+(e.pathname||"")+(e.search||"")+(e.hash||"")}},{22:22,23:23}],22:[function(e,t){"use strict";var r=e(16),n=["ms","moz","webkit","o"],o=function(e,t){if(e[t])return e[t];for(var r,o=n.length;o--;)if(r=e[n[o]+t])return r}(r,"URL"),i=!1;try{i=Boolean(new o("","http://a"))}catch(e){}if(i)t.exports=o;else{if(!r.document)throw new Error("URL parser not supported.");var s=e(15),a=e(23),u=r.document.implementation.createHTMLDocument("parser"),c=u.head.appendChild(u.createElement("base")),f=u.createElement("a"),l=function(e,t){c.href=t||s().href,f.href=e;for(var r,n=a.length;n--;)this[r=a[n]]=f[r]||"";if("/"!==this.pathname[0]&&(this.pathname="/"+this.pathname),""!==this.port){var o=this.href,i=this.hostname,u=o.indexOf(i)+i.length+1;o.slice(u,u+this.port.length)!==this.port&&(this.port="",this.host=this.hostname)}};l.prototype.toString=function(){return this.href},t.exports=l}},{15:15,16:16,23:23}],23:[function(e,t){"use strict";t.exports=["protocol","hostname","pathname","search","host","port","hash","href"]},{}],24:[function(e,t){"use strict";function r(){var e=document.activeElement===document.body?s:document.activeElement;return s=null,e}var n=e(27),o=n.flat,i={INPUT:!0,TEXTAREA:!0,SELECT:!0,BUTTON:!0},s=null;window.addEventListener("click",function(e){if(!(e.defaultPrevented||e.metaKey||e.ctrlKey||e.shiftKey||0!==e.button)){for(var t=e.target;null!=t&&("BUTTON"!==t.nodeName||"submit"!==t.type);)t=t.parentNode;s=t}}),t.exports=function(e,t){if(!e||"FORM"!==e.nodeName)throw new Error("Can only parse form elements.");for(var s=t?o:n,a="multipart/form-data"===e.enctype,u=e.elements,c={},f=a?{}:void 0,l=0,p=u.length;l<p;l++){var h=u[l];if(!h.disabled&&h.name&&i[h.nodeName]){var d=h.name,m=h.options;switch(h.type){case"submit":h===r()&&s(c,d,h.value);break;case"checkbox":case"radio":h.checked&&s(c,d,h.value);break;case"select-one":h.selectedIndex>=0&&s(c,d,m[h.selectedIndex].value);break;case"select-multiple":for(var y,v=[],g=0,b=m.length;g<b;g++)(y=m[g])&&y.selected&&v.push(y.value);s(c,d,v);break;case"file":var w=h.files;if(a&&w)for(var E=0,T=w.length;E<T;E++)s(f,d,w[E]);break;default:s(c,d,h.value)}}}return{body:c,files:f}}},{27:27}],25:[function(e,t){function r(e,t){for(var r,n=[],o=0,i=0,u="",c=t&&t.delimiter||"/";null!=(r=y.exec(e));){var f=r[0],l=r[1],p=r.index;if(u+=e.slice(i,p),i=p+f.length,l)u+=l[1];else{var h=e[i],d=r[2],m=r[3],v=r[4],g=r[5],b=r[6],w=r[7];u&&(n.push(u),u="");var E=null!=d&&null!=h&&h!==d,T="+"===b||"*"===b,x="?"===b||"*"===b,S=r[2]||c,k=v||g;n.push({name:m||o++,prefix:d||"",delimiter:S,optional:x,repeat:T,partial:E,asterisk:!!w,pattern:k?a(k):w?".*":"[^"+s(S)+"]+?"})}}return i<e.length&&(u+=e.substr(i)),u&&n.push(u),n}function n(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function o(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function i(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,i){for(var s="",a=r||{},u=(i||{}).pretty?n:encodeURIComponent,c=0;c<e.length;c++){var f=e[c];if("string"!=typeof f){var l,p=a[f.name];if(null==p){if(f.optional){f.partial&&(s+=f.prefix);continue}throw new TypeError('Expected "'+f.name+'" to be defined')}if(m(p)){if(!f.repeat)throw new TypeError('Expected "'+f.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(f.optional)continue;throw new TypeError('Expected "'+f.name+'" to not be empty')}for(var h=0;h<p.length;h++){if(l=u(p[h]),!t[c].test(l))throw new TypeError('Expected all "'+f.name+'" to match "'+f.pattern+'", but received `'+JSON.stringify(l)+"`");s+=(0===h?f.prefix:f.delimiter)+l}}else{if(l=f.asterisk?o(p):u(p),!t[c].test(l))throw new TypeError('Expected "'+f.name+'" to match "'+f.pattern+'", but received "'+l+'"');s+=f.prefix+l}}else s+=f}return s}}function s(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function a(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function c(e){return e.sensitive?"":"i"}function f(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(e,t)}function l(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(d(e[o],t,r).source);return u(new RegExp("(?:"+n.join("|")+")",c(r)),t)}function p(e,t,n){return h(r(e,n),t,n)}function h(e,t,r){m(t)||(r=t||r,t=[]);for(var n=(r=r||{}).strict,o=!1!==r.end,i="",a=0;a<e.length;a++){var f=e[a];if("string"==typeof f)i+=s(f);else{var l=s(f.prefix),p="(?:"+f.pattern+")";t.push(f),f.repeat&&(p+="(?:"+l+p+")*"),i+=p=f.optional?f.partial?l+"("+p+")?":"(?:"+l+"("+p+"))?":l+"("+p+")"}}var h=s(r.delimiter||"/"),d=i.slice(-h.length)===h;return n||(i=(d?i.slice(0,-h.length):i)+"(?:"+h+"(?=$))?"),i+=o?"$":n&&d?"":"(?="+h+"|$)",u(new RegExp("^"+i,c(r)),t)}function d(e,t,r){return m(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?f(e,t):m(e)?l(e,t,r):p(e,t,r)}var m=e(19);t.exports=d,t.exports.parse=r,t.exports.compile=function(e,t){return i(r(e,t))},t.exports.tokensToFunction=i,t.exports.tokensToRegExp=h;var y=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{19:19}],26:[function(e,t){function r(e,t,s){var a=o.call(e);if(null==s)if("[object Object]"===a)s={};else{if("[object Array]"!==a)return;s=[]}for(var u in e){var c=e[u];if(void 0!==c&&i.call(e,u))switch(o.call(c)){case"[object Array]":case"[object Object]":r(c,n(t,u),s);break;default:s[n(t,u)]=c}}return s}function n(e,t){return null!=e?e+"["+t+"]":t}var o=Object.prototype.toString,i=Object.prototype.hasOwnProperty;t.exports=r},{}],27:[function(e,t){"use strict";function r(e,t,r){for(var n,o,u,c,f=""===t?[""]:t.match(i),l=f.length,p=e,h=0;h<l;h++)o=p,n=f[h],u=f[h+1],"[]"===n&&(n=p.length),p=(c="object"==typeof p&&n in p)?p[n]:p[n]="[]"===u||s.test(u)?[]:{};return o[n]=c?a.concat(p,r):r,e}function n(e,t){var r=t.split("[]");if(1===r.length)return t;for(var n=r[0],i=Object.keys(e),s=1,a=r.length;s<a;s++)n+="["+o(i,n)+"]"+r[s];return n}function o(e,t){for(var r,n=-1,o=e.length;o--;)0===(r=e[o]).indexOf(t)&&(r=(r=r.replace(t,"")).slice(1,r.indexOf("]")))>n&&(n=Number(r));return n+1}var i=/[^\[\]]+|\[\]/g,s=/^\d+$/,a=[];r.flat=function(e,t,r){return t=n(e,t),e[t]=t in e?a.concat(e[t],r):r,e},t.exports=r},{}],28:[function(e,t){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],29:[function(e,t){"use strict";function r(e){if("number"==typeof e){if(!r[e])throw new Error("invalid status code: "+e);return e}if("string"!=typeof e)throw new TypeError("code must be a number or string");var t=parseInt(e,10);if(!isNaN(t)){if(!r[t])throw new Error("invalid status code: "+t);return t}if(!(t=r[e.toLowerCase()]))throw new Error('invalid status message: "'+e+'"');return t}var n=e(28);t.exports=r,r.codes=function(e,t){var r=[];return Object.keys(t).forEach(function(n){var o=t[n],i=Number(n);e[i]=o,e[o]=i,e[o.toLowerCase()]=i,r.push(i)}),r}(r,n),r.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},r.empty={204:!0,205:!0,304:!0},r.retry={502:!0,503:!0,504:!0}},{28:28}],30:[function(e,t){"use strict";t.exports=e(3).attach},{3:3}],31:[function(e,t){"use strict";function r(e,t){this.req=new o(this,e),this.res=new i(this,t),this.fail=this.fail.bind(this),this.assert=this.assert.bind(this),this.locals={}}var n=e(2),o=e(33),i=e(35);t.exports=r.default=r,r.prototype.fail=function(e,t,r){if("number"!=typeof e)throw new TypeError("Rill#ctx.fail: Status code must be a number.");var o=new n(e,t,r);throw this.res.status=o.code,this.res.message=o.message,o},r.prototype.assert=function(e,t,r,n){if("number"!=typeof t)throw new TypeError("Rill#ctx.assert: Status code must be a number.");e||this.fail(t,r,n)}},{2:2,33:33,35:35}],32:[function(e,t){"use strict";function r(){if(!(this instanceof r))return new r;this.stack=[]}function n(e,t,r){var n=p(e),o=n[n.length-1];o&&o.asterisk&&(o.optional=!0);var i=h(n,r);i.keys=t;for(var s=0,a=n.length;s<a;s++)"object"==typeof n[s]&&t.push(n[s]);return i}var o=e(25),i=e(5),s=e(8),a=e(1),u=e(2),c=e(31),f=e(34),l=e(30),p=o.parse,h=o.tokensToRegExp,d=Array.prototype.slice;t.exports=r.default=r,r.prototype.handler=function(){var e=a(this.stack);return function(t,r){r.statusCode=404;var n=new c(t,r);e(n).catch(function(e){404===Number(n.res.status)&&(n.res.status=500),e instanceof u||console&&console.error}).then(function(){f(n)})}},r.prototype.createServer=function(e){var t=this.handler(),r=e?s.createServer(e,t):i.createServer(t);return l(r),r},r.prototype.listen=function(e,t){return"function"==typeof e&&(t=e,e=null),e=e||{},e.port=null!=e.port?e.port:0,this.createServer(e.tls).listen(e.port,e.ip,e.backlog,t)},r.prototype.use=function(){for(var e=this.stack.length,t=this.stack.length+=arguments.length;e<t--;)this.stack[t]=arguments[t-e];return this},r.prototype.setup=function(){for(var e,t=arguments.length,r=0;r<t;r++)if(e=arguments[r]){if("function"!=typeof e)throw new TypeError("Rill#setup: Setup must be a function or falsey.");e(this)}return this},r.prototype.at=function(e){if("string"!=typeof e)throw new TypeError("Rill#at: Path name must be a string.");var t=[],r=n(e,t,{end:!1,delimiter:"/"}),o=a(d.call(arguments,1));return this.use(function(e,n){var i=e.req.matchPath,s=i.match(r);if(!s||s[0]!==i)return n();for(var a,u,c=t.length;c--;)a=t[c],u=s[c+1],a.repeat&&(u=null==u?[]:u.split("/")),e.req.params[a.name]=u;var f=s[s.length-1]||"";return e.req.matchPath!==f&&(e.req.matchPath="/"+f),o(e,function(){return e.req.matchPath=i,n()})})},r.prototype.host=function(e){if("string"!=typeof e)throw new TypeError("Rill#host: Host name must be a string.");var t=[],r=n(e,t,{strict:!0,delimiter:"."}),o=a(d.call(arguments,1));return this.use(function(e,n){var i=e.req.matchHost,s=i.match(r);if(!s||s[0]!==i)return n();for(var a,u,c=t.length;c--;)a=t[c],u=s[c+1],a.repeat&&(u=null==u?[]:u.split(".")),e.req.subdomains[a.name]=u;var f=s[s.length-1]||"";return e.req.matchHost!==f&&(e.req.matchHost=f),o(e,function(){return e.req.matchHost=i,n()})})},i.METHODS.forEach(function(e){var t=e.toLowerCase();r.prototype[t]=function(t){function r(t,r){return t.req.method!==e?r():o(t,r)}var n="string"==typeof t?1:0,o=a(d.call(arguments,n));return 1===n?this.at(t,r):this.use(r)}})},{1:1,2:2,25:25,30:30,31:31,34:34,5:5,8:8}],33:[function(e,t){(function(r){"use strict";function n(e,t){var n=t.connection,a=n.encrypted,c=(a?"https":"http")+"://"+t.headers.host,f=r.browser?t._options.parsed:o.parse(t.url,c);this.ctx=e,this.original=t,this.method=t.method,this.headers=t.headers,this.cookies=this.headers.cookie?s.parse(this.headers.cookie):{},this.params={};for(var l,p=u.length;p--;)this[l=u[p]]=f[l];this.path=t.url,this.secure=a,this.origin=c,this.matchPath=this.pathname,this.matchHost=this.hostname,this.subdomains=String(this.hostname).split(".").reverse().slice(2),this.query=i.parse(this.search,!0),this.ip=n.remoteAddress||t.socket.remoteAddress||n.socket&&n.socket.remoteAddress}var o=e(21),i=e(20),s=e(13),a=e(17),u=o.parts;t.exports=n.default=n,n.prototype.get=function(e){return this.headers[a(e)]}}).call(this,e(9))},{13:13,17:17,20:20,21:21,9:9}],34:[function(e,t){"use strict";function r(e){var t=e.req,r=e.res,u=r.body,c=r.original,f=a.stream(u),l=a.buffer(u);!1!==r.respond&&(c.headersSent||(404===Number(r.status)&&(r.get("Location")?r.status=302:u&&(r.status=200)),r.message=r.message||s[r.status],"HEAD"===t.method||s.empty[r.status]||!u?(u=null,r.remove("Content-Type"),r.remove("Content-Length")):(r.get("Content-Type")||r.set("Content-Type",i(u)),"object"!=typeof u||f||l||(u=JSON.stringify(u)),r.get("Content-Length")||f||r.set("Content-Length",o(u))),c.writeHead(r.status,r.message,n(r.headers)),!1!==r.end&&(f?u.pipe(c):c.end(u))))}function n(e){for(var t in e)null!=e[t]&&0!==e[t].length||delete e[t];return e}var o=e(10),i=e(11),s=e(29),a=e(18);t.exports=r.default=r},{10:10,11:11,18:18,29:29}],35:[function(e,t){"use strict";function r(e,t){this.ctx=e,this.original=t,this.status=t.statusCode,this.headers={},this.body=void 0,t.once("finish",function(){e.res.finished=!0})}var n=e(21),o=e(13),i=e(29),s=e(17);t.exports=r.default=r,r.prototype.get=function(e){return this.headers[s(e)]},r.prototype.set=function(e,t){this.headers[s(e)]=t},r.prototype.append=function(e,t){e=s(e);var r=this.headers,n=this.headers[e];null==n?n=[]:Array.isArray(n)||(n=[n]),r[e]=n.concat(t)},r.prototype.remove=function(e){delete this.headers[s(e)]},r.prototype.cookie=function(e,t,r){this.append("Set-Cookie",o.serialize(e,t,r))},r.prototype.clearCookie=function(e,t){(t=t||{}).expires=new Date,this.append("Set-Cookie",o.serialize(e,"",t))},r.prototype.redirect=function(e,t){var r=this.ctx.req;if(e="back"===e?r.get("Referrer"):e,!(e=e||t))throw new TypeError("Rill#ctx.res.redirect: Cannot redirect, url not specified and alternative not provided.");i.redirect[this.status]||(this.status=302),this.set("Location",n.parse(e,r.href).href)},r.prototype.refresh=function(e,t,r){var o=this.ctx.req;e=e||0,t=(t="back"===t?o.get("Referrer"):t)||r||o.href,this.set("Refresh",e+"; url="+n.parse(t,o.href).href)}},{13:13,17:17,21:21,29:29}]},{},[32])(32)});