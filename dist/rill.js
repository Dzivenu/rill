!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.rill=e()}}(function(){return function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return o(r?r:e)},f,f.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t){"use strict";function r(e){if(!Array.isArray(e))throw new TypeError("Rill: Middleware stack must be an array.");var t=n(e,[]);return function(e,r){function n(i){if(o>=i)return Promise.reject(new Error("Rill: next() called multiple times."));var s=t[i]||r;if(o=i,!s)return Promise.resolve();try{return Promise.resolve(s(e,function(){return n(i+1)}))}catch(a){return Promise.reject(a)}}var o=-1;return n(0)}}function n(e,t){for(var r,o=e.length,i=0;o>i;i++)if(r=e[i])if("function"==typeof r)t.push(r);else if(Array.isArray(r))n(r,t);else{if(!Array.isArray(r.stack))throw new TypeError("Rill: Middleware must be an functions. Got a ["+r.constructor.name+"].");n(r.stack,t)}return t}t.exports=r},{}],2:[function(e,t){"use strict";function r(e,t,n){if("number"!=typeof e)throw new TypeError("Rill#HttpError.fail: Status code must be a number.");this.name="HttpError",this.code=e,this.message=t||i[e];for(var o in n)this[o]=n[o];Error.captureStackTrace?Error.captureStackTrace(this,r):Error.call(this)}function n(e,t,n){throw new r(e,t,n)}function o(e,t,r,o){e||n(t,r,o)}var i=e(5).STATUS_CODES;r.prototype=new Error,r.fail=n,r.assert=o,t.exports=r},{5:5}],3:[function(e,t){"use strict";function r(e,t){return e._referrer=b&&b.referrer,e._initialize=t!==!1,e._pending_refresh=null,e._onHistory=a.bind(e),e._onSubmit=u.bind(e),e._onClick=c.bind(e),e.prependListener("listening",n),e.prependListener("close",o),e}function n(){l.addEventListener("popstate",this._onHistory),l.addEventListener("submit",this._onSubmit),l.addEventListener("click",this._onClick),this.prependListener("request",i),this._pending_load=this._initialize&&setTimeout(this._onHistory,0)}function o(){l.removeEventListener("popstate",this._onHistory),l.removeEventListener("submit",this._onSubmit),l.removeEventListener("click",this._onClick),this.removeListener("request",i),clearTimeout(this._pending_load),clearTimeout(this._pending_refresh)}function i(e,t){e.headers.referer=e.headers.referer||e.socket.server._referrer,t.once("finish",s.bind(null,e,t))}function s(e,t){var r=e._options.parsed,n=e.socket.server;clearTimeout(n._pending_refresh);var o=t.getHeader("set-cookie");if(o&&o.length)if("string"==typeof o)b.cookie=o;else for(var i=0;i<o.length;i++)b.cookie=o[i];var s=t.getHeader("refresh");if(s){var a=s.split(" url="),u=1e3*parseInt(a[0],10),c=a[1];n._pending_refresh=setTimeout(f.bind(null,n,{url:c}),u)}if("GET"===e.method&&!t.getHeader("location")){if(e._scroll!==!1)if(""===r.hash)l.scrollTo(0,0);else{var p=b.getElementById(r.hash.slice(1));p&&p.scrollIntoView&&p.scrollIntoView({block:"start",behavior:m.pathname===r.pathname&&(m.search||"")===(r.search||"")?"smooth":"auto"})}e.headers.referer!==r.href&&(n._referrer=r.href,e._history!==!1&&g.pushState(null,b.title,e.url))}}function a(){f(this,{url:m.href,scroll:!1,history:!1})}function u(e){if(!e.defaultPrevented){var t=e.target,r=t.action||t.getAttribute("action")||"",n=p.parse(r,m.href);t.target&&"_self"!==t.target||n.host===m.host&&n.protocol===m.protocol&&(e.preventDefault(),f(this,{url:r,method:t.method||t.getAttribute("method"),form:t}),t.hasAttribute("data-noreset")||t.reset())}}function c(e){if(!(e.defaultPrevented||e.button||e.metaKey||e.ctrlKey||e.shiftKey)){for(var t=e.target;null!=t&&"A"!==t.nodeName;)t=t.parentNode;t&&t.href&&(t.target&&"_self"!==t.target||t.rel&&"external"===t.rel||t.hasAttribute("download")||t.host&&t.host!==m.host||t.protocol&&":"!==t.protocol&&t.protocol!==m.protocol||(e.preventDefault(),f(this,t.href)))}}function f(e,t,r){if("object"==typeof t?r=t:"string"==typeof t&&(r=r||{},r.url=t),!r||"string"!=typeof r.url)return Promise.reject(new TypeError("@rill/http/adapter/browser#fetch: url must be a string."));var n=r.parsed=p.parse(r.url,m.href);return new Promise(function(t){var o=y._createIncomingMessage(e,r),i=v._createServerResponse(o),s=r.form;if(s){o.headers["content-type"]=s.enctype||s.getAttribute("enctype")||"application/x-www-form-urlencoded";var a=h(s);r.body=a.body,r.files=a.files}if("GET"===o.method){var u=r.query||r.body;u&&(n=r.parsed=p.parse(n.pathname+"?"+d.stringify(u,!0)+n.hash,m.href))}else o.body=r.body,o.files=r.files;o._scroll=r.scroll,o._history=r.history,o.url=n.pathname+n.search+n.hash,i.once("finish",function(){o.complete=!0,o.emit("end");var n=i.getHeader("location");return t(!n||void 0!==r.redirect&&"follow"!==r.redirect?[i._body,{url:o.url,headers:i.getHeaders(),status:i.statusCode,statusText:i.statusMessage}]:f(e,{url:n,history:r.history,scroll:r.scroll}))}),setTimeout(e.emit.bind(e,"request",o,i),0)})}var l=e(17),p=e(22),h=e(25),d=e(21),m=e(16)(),y=e(4),v=e(6),g=l.history,b=l.document;r.fetch=f,t.exports=r["default"]=r},{16:16,17:17,21:21,22:22,25:25,4:4,6:6}],4:[function(e,t){"use strict";function r(e){this.headers={},this.socket=this.connection=e}function n(e,t){var n=t.parsed,i=new r({server:e,remoteAddress:"127.0.0.1",encrypted:"https:"===n.protocol}),s=i.headers;s.referer=s.referer||s.referrer,s.date=(new Date).toUTCString(),s.host=n.host,s.cookie=document.cookie,s["user-agent"]=navigator.userAgent,s["accept-language"]=navigator.language,s.connection="keep-alive",s["cache-control"]="max-age=0",s.accept="*/*";var a=o(t.headers);for(var u in a)s[u]=a[u];return i.method=t.method?t.method.toUpperCase():"GET",i._options=t,i}function o(e){if(null==e||"function"!=typeof e.forEach)return e;var t={};return e.forEach(function(e,r){t[r]=e}),t}var i=e(15);r._createIncomingMessage=n,t.exports=r["default"]=r,r.prototype=Object.create(i.prototype),r.prototype.httpVersionMajor=1,r.prototype.httpVersionMinor=1,r.prototype.httpVersion=r.prototype.httpVersionMajor+"."+r.prototype.httpVersionMinor,r.prototype.complete=!1,r.prototype.url="",r.prototype.headers={},r.prototype.method="GET"},{15:15}],5:[function(e,t,r){"use strict";var n=e(7),o=e(4),i=e(6),s=e(29);r.STATUS_CODES=s,r.METHODS=["OPTIONS","HEAD","GET","PUT","POST","PATCH","DELETE"],r.Server=n,r.IncomingMessage=o,r.ServerResponse=i,r.createServer=function(){var e=arguments[arguments.length-1];return new n(e)}},{29:29,4:4,6:6,7:7}],6:[function(e,t){"use strict";function r(e){this._headers={},this.socket=this.connection=e.socket}function n(e){var t=new r(e);return t._body=[],t}var o=e(15),i=e(29);r._createServerResponse=n,t.exports=r["default"]=r,r.prototype=Object.create(o.prototype),r.prototype.statusCode=null,r.prototype.statusMessage=null,r.prototype.sendDate=!0,r.prototype.finished=!1,r.prototype.headersSent=!1,r.prototype.writeContinue=r.prototype.setTimeout=r.prototype.addTrailers=function(){},r.prototype.write=function(e,t,r){this._body.push(e),"function"==typeof t&&(r=t,t=null),"function"==typeof r&&this.once("finish",r)},r.prototype.writeHead=function(e,t,r){if(!this.finished&&(this.statusCode=e,this.headersSent=!0,t&&("object"==typeof t?r=t:this.statusMessage=t),"object"==typeof r))for(var n in r)this.setHeader(n,r[n])},r.prototype.getHeaders=function(){var e={};for(var t in this._headers)e[t]=this._headers[t];return e},r.prototype.getHeaderNames=function(){return Object.keys(this._headers)},r.prototype.getHeader=function(e){return this._headers[e.toLowerCase()]},r.prototype.hasHeader=function(e){return e.toLowerCase()in this._headers},r.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},r.prototype.setHeader=function(e,t){this._headers[e.toLowerCase()]=t},r.prototype.end=function(e,t,r){this.finished||("function"==typeof e?(r=e,e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this._body.push(e),"function"==typeof r&&this.once("finish",r),null==this.statusCode&&(this.statusCode=200),null==this.statusMessage&&(this.statusMessage=i[this.statusCode]),this.sendDate&&(this._headers.date=(new Date).toUTCString()),this._headers.status=this.statusCode,this.headersSent=!0,this.finished=!0,this.emit("finish"))}},{15:15,29:29}],7:[function(e,t){"use strict";function r(e){e&&this.on("request",e)}var n=e(15);t.exports=r["default"]=r,r.prototype=Object.create(n.prototype),r.prototype.listen=function(){var e=arguments[arguments.length-1];return"function"==typeof e&&this.once("listening",e),setTimeout(function(){this.listening=!0,this.emit("listening")}.bind(this),0),this},r.prototype.close=function(e){return"function"==typeof e&&this.once("close",e),setTimeout(function(){this.listening=!1,this.emit("close")}.bind(this),0),this}},{15:15}],8:[function(e,t){"use strict";t.exports=e(5)},{5:5}],9:[function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function s(){m&&h&&(m=!1,h.length?d=h.concat(d):y=-1,d.length&&a())}function a(){if(!m){var e=o(s);m=!0;for(var t=d.length;t;){for(h=d,d=[];++y<t;)h&&h[y].run();y=-1,t=d.length}h=null,m=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var f,l,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(e){f=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var h,d=[],m=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new u(e,t)),1!==d.length||m||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.binding=function(){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],10:[function(e,t){"use strict";t.exports=function(e){var t,r;if(!e)return 0;for(e=e.toString(),t=r=e.length;t--;){var n=e[t].charCodeAt();n>=56320&&57343>=n&&t--,n>127&&2047>=n?r++:n>2047&&65535>=n&&(r+=2)}return r}},{}],11:[function(e,t){"use strict";t.exports={Buffer:function(){}}},{}],12:[function(e,t){"use strict";t.exports={lookup:function(){}}},{}],13:[function(e,t){"use strict";function r(e){return e instanceof s}function n(e){return"function"==typeof e.pipe}function o(e){if("function"==typeof e.toJSON||e.constructor===Object||e.constructor===Array)return!0;try{return JSON.stringify(e),!0}catch(t){return!1}}var i=/^\s*</,s=e(11).Buffer,a=e(12).lookup;t.exports=function(e){if(null!=e&&"function"!=typeof e){if("object"==typeof e){if(r(e))return"application/octet-stream";if(n(e))return a(e.path)||"application/octet-stream";if(o(e))return"application/json; charset=UTF-8"}return"text/"+(i.test(String(e))?"html":"plain")+"; charset=UTF-8"}}},{11:11,12:12}],14:[function(e,t,r){"use strict";function n(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var r={},n=t||{},o=e.split(u),a=n.decode||s,c=0;c<o.length;c++){var f=o[c],l=f.indexOf("=");if(!(0>l)){var p=f.substr(0,l).trim(),h=f.substr(++l,f.length).trim();'"'==h[0]&&(h=h.slice(1,-1)),void 0==r[p]&&(r[p]=i(h,a))}}return r}function o(e,t,r){var n=r||{},o=n.encode||a;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!c.test(e))throw new TypeError("argument name is invalid");var i=o(t);if(i&&!c.test(i))throw new TypeError("argument val is invalid");var s=e+"="+i;if(null!=n.maxAge){var u=n.maxAge-0;if(isNaN(u))throw new Error("maxAge should be a Number");s+="; Max-Age="+Math.floor(u)}if(n.domain){if(!c.test(n.domain))throw new TypeError("option domain is invalid");s+="; Domain="+n.domain}if(n.path){if(!c.test(n.path))throw new TypeError("option path is invalid");s+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");s+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.sameSite){var f="string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite;switch(f){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return s}function i(e,t){try{return t(e)}catch(r){return e}}r.parse=n,r.serialize=o;var s=decodeURIComponent,a=encodeURIComponent,u=/; */,c=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},{}],15:[function(e,t){function r(e){return"function"==typeof e}function n(e){if(!r(e))throw TypeError("Invalid listener")}function o(e,t,r){switch(r.length){case 1:t.call(e);break;case 2:t.call(e,r[1]);break;case 3:t.call(e,r[1],r[2]);break;default:t.apply(e,a.call(r,1))}}function i(e,t,o,i){n(o);var s=e.$e||(e.$e={}),a=s[t];return a?r(a)?s[t]=i?[o,a]:[a,o]:i?a.unshift(o):a.push(o):s[t]=o,e}function s(){this.$e=this.$e||{}}var a=Array.prototype.slice;s.EventEmitter=s,s.prototype={$e:null,emit:function(e){var t=arguments,n=this.$e;if(n){var i=n&&n[e];if(!i){if("error"===e){var s=t[1];if(!(s instanceof Error)){var u=s;s=new Error("Error: "+u),s.context=u}throw s}return!1}if(r(i))o(this,i,t);else{i=a.call(i);for(var c=0,f=i.length;f>c;c++){var l=i[c];o(this,l,t)}}return!0}},on:function(e,t){return i(this,e,t,!1)},prependListener:function(e,t){return i(this,e,t,!0)},once:function(e,t){function r(){this.removeListener(e,r),t&&(t.apply(this,arguments),t=null)}return n(t),this.on(e,r),this},removeListener:function(e,t){n(t);var o,i=this.$e;if(i&&(o=i[e]))if(r(o))o===t&&delete i[e];else for(var s=o.length-1;s>=0;s--)o[s]===t&&o.splice(s,1);return this},removeAllListeners:function(e){var t=this.$e;t&&delete t[e]},listenerCount:function(e){var t=this.$e,n=t&&t[e];return n?r(n)?1:n.length:0}},t.exports=s},{}],16:[function(e,t){"use strict";var r=e(17);t.exports=function(){return r.history&&r.history.location||r.location||{href:""}}},{17:17}],17:[function(e,t){(function(e){t.exports="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(e,t){"use strict";function r(e){if("string"!=typeof e)throw new TypeError("Header Fields must be strings.");return e=e.toLowerCase(),"referrer"===e&&(e="referer"),e}t.exports=r},{}],19:[function(e,t){(function(e){"use strict";function r(){}function n(e){var t=e.toLowerCase();return function(e){var r=typeof e;switch(r){case"object":case"function":return o.call(e)===s[t];default:return r===t}}}var o=Object.prototype.toString,i=e.Buffer||r,s={string:"[object String]",number:"[object Number]","boolean":"[object Boolean]",date:"[object Date]",regexp:"[object RegExp]",error:"[object Error]","function":"[object Function]",arguments:"[object Arguments]",object:"[object Object]",array:"[object Array]"};t.exports={string:n("String"),number:n("Number"),"boolean":n("Boolean"),date:n("Date"),regexp:n("RegExp"),error:n("Error"),"function":n("Function"),arguments:n("Arguments"),object:n("Object"),array:n("Array"),stream:function(e){return null!=e&&"function"==typeof e.pipe},buffer:function(e){return e instanceof i},empty:function(e){for(var t in e)return!1;return!0}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],21:[function(e,t,r){"use strict";var n=/([^=?&]+)=?([^&]*)/g,o=e(27),i=e(28);r.stringify=function(e,t){t&&(e=o(e));var r=Object.keys(e);if(!r.length)return"";for(var n,i=0,s=r.length;s>i;i++)n=r[i],r[i]=encodeURIComponent(n)+"="+encodeURIComponent(e[n]);return r.join("&")},r.parse=function(e,t){for(var r,o=t?i:i.flat,s={};r=n.exec(e);)o(s,decodeURIComponent(r[1]),decodeURIComponent(r[2]));return s}},{27:27,28:28}],22:[function(e,t,r){"use strict";function n(e,t){t=t||"";var r=e+a+t,n=u[r];if(!n){var o=new i(e,t);n={};for(var c,f,l=s.length;l--;)c=s[l],f=o[c],null==f&&(f=""),n[c]=f;n=u[r]=Object.freeze(n)}return n}function o(e){if("object"!=typeof e||null==e)throw new TypeError("URL must be an object.");return(e.protocol?e.protocol+"//":"")+(e.host||(e.hostname||"")+(e.port?":"+e.port:""))+(e.pathname||"")+(e.search||"")+(e.hash||"")}var i=e(23),s=e(24),a="~#~",u={};r.parts=s,r.cache=u,r.parse=n,r.stringify=o},{23:23,24:24}],23:[function(e,t){"use strict";function r(e,t){if(e[t])return e[t];for(var r,n=o.length;n--;)if(r=e[o[n]+t])return r}var n=e(17),o=["ms","moz","webkit","o"],i=r(n,"URL"),s=!1;try{s=Boolean(new i("","http://a"))}catch(a){}if(s)t.exports=i;else{if(!n.document)throw new Error("URL parser not supported.");var u=e(16),c=e(24),f=n.document.implementation.createHTMLDocument("parser"),l=f.head.appendChild(f.createElement("base")),p=f.createElement("a"),h=function(e,t){l.href=t||u().href,p.href=e;for(var r,n=c.length;n--;)r=c[n],this[r]=p[r]||"";if("/"!==this.pathname[0]&&(this.pathname="/"+this.pathname),""!==this.port){var o=this.href,i=this.hostname,s=o.indexOf(i)+i.length+1,a=o.slice(s,s+this.port.length);a!==this.port&&(this.port="",this.host=this.hostname)}};h.prototype.toString=function(){return this.href},t.exports=h}},{16:16,17:17,24:24}],24:[function(e,t){"use strict";t.exports=["protocol","hostname","pathname","search","host","port","hash","href"]},{}],25:[function(e,t){"use strict";function r(){var e=document.activeElement===document.body?s:document.activeElement;return s=null,e}var n=e(28),o=n.flat,i={INPUT:!0,TEXTAREA:!0,SELECT:!0,BUTTON:!0},s=null;window.addEventListener("click",function(e){if(!(e.defaultPrevented||e.metaKey||e.ctrlKey||e.shiftKey||0!==e.button)){for(var t=e.target;null!=t&&("BUTTON"!==t.nodeName||"submit"!==t.type);)t=t.parentNode;s=t}}),t.exports=function(e,t){if(!e||"FORM"!==e.nodeName)throw new Error("Can only parse form elements.");for(var s=t?o:n,a="multipart/form-data"===e.enctype,u=e.elements,c={},f=a?{}:void 0,l=0,p=u.length;p>l;l++){var h=u[l];if(!h.disabled&&h.name&&i[h.nodeName]){var d=h.name,m=h.options;switch(h.type){case"submit":h===r()&&s(c,d,h.value);break;case"checkbox":case"radio":h.checked&&s(c,d,h.value);break;case"select-one":h.selectedIndex>=0&&s(c,d,m[h.selectedIndex].value);break;case"select-multiple":for(var y,v=[],g=0,b=m.length;b>g;g++)y=m[g],y&&y.selected&&v.push(y.value);s(c,d,v);break;case"file":var w=h.files;if(a&&w)for(var E=0,x=w.length;x>E;E++)s(f,d,w[E]);break;default:s(c,d,h.value)}}}return{body:c,files:f}}},{28:28}],26:[function(e,t){function r(e,t){for(var r,n=[],o=0,i=0,s="",c=t&&t.delimiter||"/";null!=(r=v.exec(e));){var f=r[0],l=r[1],p=r.index;if(s+=e.slice(i,p),i=p+f.length,l)s+=l[1];else{var h=e[i],d=r[2],m=r[3],y=r[4],g=r[5],b=r[6],w=r[7];s&&(n.push(s),s="");var E=null!=d&&null!=h&&h!==d,x="+"===b||"*"===b,T="?"===b||"*"===b,S=r[2]||c,k=y||g;n.push({name:m||o++,prefix:d||"",delimiter:S,optional:T,repeat:x,partial:E,asterisk:!!w,pattern:k?u(k):w?".*":"[^"+a(S)+"]+?"})}}return i<e.length&&(s+=e.substr(i)),s&&n.push(s),n}function n(e,t){return s(r(e,t))}function o(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function i(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function s(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,n){for(var s="",a=r||{},u=n||{},c=u.pretty?o:encodeURIComponent,f=0;f<e.length;f++){var l=e[f];if("string"!=typeof l){var p,h=a[l.name];if(null==h){if(l.optional){l.partial&&(s+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(y(h)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(h)+"`");if(0===h.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var d=0;d<h.length;d++){if(p=c(h[d]),!t[f].test(p))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(p)+"`");s+=(0===d?l.prefix:l.delimiter)+p}}else{if(p=l.asterisk?i(h):c(h),!t[f].test(p))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+p+'"');s+=l.prefix+p}}else s+=l}return s}}function a(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function c(e,t){return e.keys=t,e}function f(e){return e.sensitive?"":"i"}function l(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return c(e,t)}function p(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(m(e[o],t,r).source);var i=new RegExp("(?:"+n.join("|")+")",f(r));return c(i,t)}function h(e,t,n){return d(r(e,n),t,n)}function d(e,t,r){y(t)||(r=t||r,t=[]),r=r||{};for(var n=r.strict,o=r.end!==!1,i="",s=0;s<e.length;s++){var u=e[s];if("string"==typeof u)i+=a(u);else{var l=a(u.prefix),p="(?:"+u.pattern+")";t.push(u),u.repeat&&(p+="(?:"+l+p+")*"),p=u.optional?u.partial?l+"("+p+")?":"(?:"+l+"("+p+"))?":l+"("+p+")",i+=p}}var h=a(r.delimiter||"/"),d=i.slice(-h.length)===h;return n||(i=(d?i.slice(0,-h.length):i)+"(?:"+h+"(?=$))?"),i+=o?"$":n&&d?"":"(?="+h+"|$)",c(new RegExp("^"+i,f(r)),t)}function m(e,t,r){return y(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?l(e,t):y(e)?p(e,t,r):h(e,t,r)}var y=e(20);t.exports=m,t.exports.parse=r,t.exports.compile=n,t.exports.tokensToFunction=s,t.exports.tokensToRegExp=d;var v=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{20:20}],27:[function(e,t){function r(e,t,s){var a=o.call(e);if(null==s)if("[object Object]"===a)s={};else{if("[object Array]"!==a)return;s=[]}for(var u in e){var c=e[u];if(void 0!==c&&i.call(e,u))switch(o.call(c)){case"[object Array]":case"[object Object]":r(c,n(t,u),s);break;default:s[n(t,u)]=c}}return s}function n(e,t){return null!=e?e+"["+t+"]":t}var o=Object.prototype.toString,i=Object.prototype.hasOwnProperty;t.exports=r},{}],28:[function(e,t){"use strict";function r(e,t,r){for(var n,o,i,c,f=""===t?[""]:t.match(s),l=f.length,p=e,h=0;l>h;h++)o=p,n=f[h],i=f[h+1],"[]"===n&&(n=p.length),p=(c="object"==typeof p&&n in p)?p[n]:p[n]="[]"===i||a.test(i)?[]:{};return o[n]=c?u.concat(p,r):r,e}function n(e,t,r){return t=o(e,t),e[t]=t in e?u.concat(e[t],r):r,e}function o(e,t){var r=t.split("[]");if(1===r.length)return t;for(var n=r[0],o=Object.keys(e),s=1,a=r.length;a>s;s++)n+="["+i(o,n)+"]"+r[s];return n}function i(e,t){for(var r,n=-1,o=e.length;o--;)r=e[o],0===r.indexOf(t)&&(r=r.replace(t,""),r=r.slice(1,r.indexOf("]")),r>n&&(n=Number(r)));return n+1}var s=/[^\[\]]+|\[\]/g,a=/^\d+$/,u=[];r.flat=n,t.exports=r},{}],29:[function(e,t){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],30:[function(e,t){"use strict";function r(e,t){var r=[];return Object.keys(t).forEach(function(n){var o=t[n],i=Number(n);e[i]=o,e[o]=i,e[o.toLowerCase()]=i,r.push(i)}),r}function n(e){if("number"==typeof e){if(!n[e])throw new Error("invalid status code: "+e);return e}if("string"!=typeof e)throw new TypeError("code must be a number or string");var t=parseInt(e,10);if(!isNaN(t)){if(!n[t])throw new Error("invalid status code: "+t);return t}if(t=n[e.toLowerCase()],!t)throw new Error('invalid status message: "'+e+'"');return t}var o=e(29);t.exports=n,n.codes=r(n,o),n.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},n.empty={204:!0,205:!0,304:!0},n.retry={502:!0,503:!0,504:!0}},{29:29}],31:[function(e,t){"use strict";function r(e,t){this.req=new o(this,e),this.res=new i(this,t),this.fail=this.fail.bind(this),this.assert=this.assert.bind(this),this.locals={}}var n=e(2),o=e(33),i=e(35);t.exports=r["default"]=r,r.prototype.fail=function(e,t,r){if("number"!=typeof e)throw new TypeError("Rill#ctx.fail: Status code must be a number.");var o=new n(e,t,r);throw this.res.status=o.code,this.res.message=o.message,o},r.prototype.assert=function(e,t,r,n){if("number"!=typeof t)throw new TypeError("Rill#ctx.assert: Status code must be a number.");e||this.fail(t,r,n)}},{2:2,33:33,35:35}],32:[function(e,t){(function(r){"use strict";function n(){return this instanceof n?void(this.stack=[]):new n}function o(e,t,r){var n=h(e),o=n[n.length-1];o&&o.asterisk&&(o.optional=!0);var i=d(n,r);i.keys=t;for(var s=0,a=n.length;a>s;s++)"object"==typeof n[s]&&t.push(n[s]);return i}var i=e(26),s=e(5),a=e(8),u=e(1),c=e(2),f=e(31),l=e(34),p=r.browser&&e(3),h=i.parse,d=i.tokensToRegExp,m=Array.prototype.slice;t.exports=n["default"]=n,n.prototype.handler=function(){var e=u(this.stack);return function(t,r){function n(e){404===Number(i.res.status)&&(i.res.status=500),e instanceof c||console&&console.error&&void 0}function o(){l(i)}r.statusCode=404;var i=new f(t,r);e(i)["catch"](n).then(o)}},n.prototype.createServer=function(e){var t=this.handler(),n=e?a.createServer(e,t):s.createServer(t);return r.browser&&p(n),n},n.prototype.listen=function(e,t){return"function"==typeof e&&(t=e,e=null),e=e||{},e.port=null!=e.port?e.port:0,this.createServer(e.tls).listen(e.port,e.ip,e.backlog,t)},n.prototype.use=function(){for(var e=this.stack.length,t=this.stack.length+=arguments.length,r=t;e<r--;)this.stack[r]=arguments[r-e];return this},n.prototype.setup=function(){for(var e,t=arguments.length,r=0;t>r;r++)if(e=arguments[r]){if("function"!=typeof e)throw new TypeError("Rill#setup: Setup must be a function or falsey.");e(this)}return this},n.prototype.at=function(e){if("string"!=typeof e)throw new TypeError("Rill#at: Path name must be a string.");var t=[],r=o(e,t,{end:!1,delimiter:"/"}),n=u(m.call(arguments,1));return this.use(function(e,o){var i=e.req.matchPath,s=i.match(r);if(!s||s[0]!==i)return o();for(var a,u,c=t.length;c--;)a=t[c],u=s[c+1],a.repeat&&(u=null==u?[]:u.split("/")),e.req.params[a.name]=u;var f=s[s.length-1]||"";return e.req.matchPath!==f&&(e.req.matchPath="/"+f),n(e,function(){return e.req.matchPath=i,o()})})},n.prototype.host=function(e){if("string"!=typeof e)throw new TypeError("Rill#host: Host name must be a string.");var t=[],r=o(e,t,{strict:!0,delimiter:"."}),n=u(m.call(arguments,1));return this.use(function(e,o){var i=e.req.matchHost,s=i.match(r);if(!s||s[0]!==i)return o();for(var a,u,c=t.length;c--;)a=t[c],u=s[c+1],a.repeat&&(u=null==u?[]:u.split(".")),e.req.subdomains[a.name]=u;var f=s[s.length-1]||"";return e.req.matchHost!==f&&(e.req.matchHost=f),n(e,function(){return e.req.matchHost=i,o()})})},s.METHODS.forEach(function(e){var t=e.toLowerCase();n.prototype[t]=function(t){function r(t,r){return t.req.method!==e?r():o(t,r)}var n="string"==typeof t?1:0,o=u(m.call(arguments,n));return 1===n?this.at(t,r):this.use(r)}})}).call(this,e(9))},{1:1,2:2,26:26,3:3,31:31,34:34,5:5,8:8,9:9}],33:[function(e,t){(function(r){"use strict";function n(e,t){var n=t.connection,a=n.encrypted,c=a?"https":"http",f=c+"://"+t.headers.host,l=r.browser?t._options.parsed:o.parse(t.url,f);this.ctx=e,this.original=t,this.method=t.method,this.headers=t.headers,this.cookies=this.headers.cookie?s.parse(this.headers.cookie):{},this.params={};for(var p,h=u.length;h--;)p=u[h],this[p]=l[p];this.path=t.url,this.secure=a,this.origin=f,this.matchPath=this.pathname,this.matchHost=this.hostname,this.subdomains=String(this.hostname).split(".").reverse().slice(2),this.query=i.parse(this.search,!0),this.ip=n.remoteAddress||t.socket.remoteAddress||n.socket&&n.socket.remoteAddress}var o=e(22),i=e(21),s=e(14),a=e(18),u=o.parts;t.exports=n["default"]=n,n.prototype.get=function(e){return this.headers[a(e)]}}).call(this,e(9))},{14:14,18:18,21:21,22:22,9:9}],34:[function(e,t){"use strict";function r(e){var t=e.req,r=e.res,u=r.body,c=r.original,f=a.stream(u),l=a.buffer(u);r.respond!==!1&&(c.headersSent||(404===Number(r.status)&&(r.get("Location")?r.status=302:u&&(r.status=200)),r.message=r.message||s[r.status],"HEAD"===t.method||s.empty[r.status]||!u?(u=null,r.remove("Content-Type"),r.remove("Content-Length")):(r.get("Content-Type")||r.set("Content-Type",i(u)),"object"!=typeof u||f||l||(u=JSON.stringify(u)),r.get("Content-Length")||f||r.set("Content-Length",o(u))),c.writeHead(r.status,r.message,n(r.headers)),r.end!==!1&&(f?u.pipe(c):c.end(u))))}function n(e){for(var t in e)(null==e[t]||0===e[t].length)&&delete e[t];return e}var o=e(10),i=e(13),s=e(30),a=e(19);t.exports=r["default"]=r},{10:10,13:13,19:19,30:30}],35:[function(e,t){"use strict";function r(e,t){this.ctx=e,this.original=t,this.status=t.statusCode,this.headers={},this.body=void 0,t.once("finish",function(){e.res.finished=!0})}var n=e(22),o=e(14),i=e(30),s=e(18);t.exports=r["default"]=r,r.prototype.get=function(e){return this.headers[s(e)]},r.prototype.set=function(e,t){this.headers[s(e)]=t},r.prototype.append=function(e,t){e=s(e);var r=this.headers,n=this.headers[e];null==n?n=[]:Array.isArray(n)||(n=[n]),r[e]=n.concat(t)},r.prototype.remove=function(e){delete this.headers[s(e)]},r.prototype.cookie=function(e,t,r){this.append("Set-Cookie",o.serialize(e,t,r))},r.prototype.clearCookie=function(e,t){t=t||{},t.expires=new Date,this.append("Set-Cookie",o.serialize(e,"",t))},r.prototype.redirect=function(e,t){var r=this.ctx.req;if(e="back"===e?r.get("Referrer"):e,e=e||t,!e)throw new TypeError("Rill#ctx.res.redirect: Cannot redirect, url not specified and alternative not provided.");i.redirect[this.status]||(this.status=302),this.set("Location",n.parse(e,r.href).href)},r.prototype.refresh=function(e,t,r){var o=this.ctx.req;e=e||0,t="back"===t?o.get("Referrer"):t,t=t||r||o.href,this.set("Refresh",e+"; url="+n.parse(t,o.href).href)}},{14:14,18:18,22:22,30:30}]},{},[32])(32)});