!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.rill=t()}}(function(){var t;return function e(t,r,n){function o(i,a){if(!r[i]){if(!t[i]){var h="function"==typeof require&&require;if(!a&&h)return h(i,!0);if(s)return s(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){var r=t[i][1][e];return o(r?r:e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var s="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(t,e){"use strict";function r(){this.navigate(h.href,{popState:!0})}function n(t){if(!t.defaultPrevented){var e=t.target,r=!1,n=s(e,"target"),o=s(e,"action"),u=s(e,"method").toUpperCase(),c=a(e,!0);if(!n||"_self"===n){if("GET"===u){var f=i.parse(i.resolve(h.href,o));delete f.search,f.query=c.body,r=this.navigate(i.format(f))}else r=this.navigate({url:o,method:u,body:c.body,files:c.files,headers:{"content-type":s(e,"enctype")}});r&&(e.hasAttribute("data-noreset")||e.reset(),t.preventDefault())}}}function o(t){if(!(t.defaultPrevented||t.metaKey||t.ctrlKey||t.shiftKey||0!==t.button)){var e=t.target;if("submit"===e.type&&e!==document.activeElement)return void e.focus();for(;null!=e&&"A"!==e.nodeName;)e=e.parentNode;if(e){var r=s(e,"href"),n=s(e,"target"),o=s(e,"rel");r&&(n&&"_self"!==n||u.test(o)||e.hasAttribute("download")||this.navigate(r)&&t.preventDefault())}}}function s(t,e){var r=t.getAttribute(e)||t[e];return"string"==typeof r?r:""}var i=t(30),a=t(6),h=window.history.location||window.location,u=/(?:^|\s+)external(?:\s+|$)/;e.exports={onPopState:r,onSubmit:n,onClick:o}},{30:30,6:6}],2:[function(t,e){"use strict";var r=t(5),n=t(3),o=t(4),s=t(8),i=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"];e.exports={STATUS_CODES:s,METHODS:i,Server:r,IncomingMessage:n,ServerResponse:o,createServer:function(){var t=arguments[arguments.length-1];return new r(t)}}},{3:3,4:4,5:5,8:8}],3:[function(t,e){"use strict";function r(t){this.url=t.url,this.method=t.method||"GET",this.headers=t.headers||{},this.headers.referer=t.referrer,this.headers.date=(new Date).toUTCString(),this.headers.host=o.host,this.headers.cookie=document.cookie,this.headers["user-agent"]=navigator.userAgent,this.headers["accept-language"]=navigator.language,this.headers.connection="keep-alive",this.headers["cache-control"]="max-age=0",this.headers.accept="*/*",this.connection={remoteAddress:"127.0.0.1",encrypted:"https:"===o.protocol},this.body=t.body,this.files=t.files}var n=t(17).EventEmitter,o=window.history.location||window.location,s=r.prototype=Object.create(n.prototype);s.httpVersionMajor=1,s.httpVersionMinor=1,s.httpVersion=s.httpVersionMajor+"."+s.httpVersionMinor,s.complete=!1,e.exports=r},{17:17}],4:[function(t,e){"use strict";function r(){this._headers={}}var n=t(17).EventEmitter,o=t(8),s=function(){},i=r.prototype=Object.create(n.prototype);i.statusCode=null,i.statusMessage=null,i.sendDate=!0,i.finished=!1,i.write=i.writeContinue=i.setTimeout=i.addTrailers=s,i.writeHead=function(t,e,r){if(!this.finished&&(this.statusCode=t,this.headersSent=!0,e&&("object"==typeof e?r=e:this.statusMessage=e),"object"==typeof r))for(var n in r)this.setHeader(n,r[n])},i.getHeader=function(t){return this._headers[t.toLowerCase()]},i.removeHeader=function(t){delete this._headers[t.toLowerCase()]},i.setHeader=function(t,e){this._headers[t.toLowerCase()]=e},i.end=function(){this.finished||(null==this.statusMessage&&(this.statusMessage=o[this.statusCode]),this.sendDate&&(this._headers.date=(new Date).toUTCString()),this._headers.status=this.statusCode,this.headersSent=!0,this.finished=!0,this.emit("finish"))},e.exports=r},{17:17,8:8}],5:[function(t,e){"use strict";function r(t){if(this._handle=this,this._pending_refresh=null,t){if("function"!=typeof t)throw new TypeError("listener must be a function");this.on("request",t)}}var n=t(30),o=t(17).EventEmitter,s=t(1),i=t(3),a=t(4),h=window.history,u=h.location||window.location,c=/#(.+)$/,f=r.prototype=Object.create(o.prototype),l=document.referrer;f.listen=function(){var t=arguments[arguments.length-1];return"function"==typeof t&&this.once("listening",t),this._onPopState=s.onPopState.bind(this),this._onSubmit=s.onSubmit.bind(this),this._onClick=s.onClick.bind(this),this.once("listening",this._onPopState),setTimeout(function(){this.listening=!0,this.emit("listening"),window.addEventListener("popstate",this._onPopState),window.addEventListener("submit",this._onSubmit),window.addEventListener("click",this._onClick)}.bind(this),0),this},f.close=function(){var t=arguments[arguments.length-1];return"function"==typeof t&&this.once("close",t),setTimeout(function(){window.removeEventListener("popstate",this._onPopState),window.removeEventListener("submit",this._onSubmit),window.removeEventListener("click",this._onClick),this.listening=!1,this.emit("close")}.bind(this),0),this},f.navigate=function(t,e){"object"!=typeof e&&(e={}),"string"==typeof t&&(t={url:t});var r=n.resolve(u.href,t.url),o=n.parse(r);if(o.host!==u.host)return!1;if(o.protocol!==u.protocol)return!1;t.url=o.path+(o.hash||""),t.referrer=l,t=new i(t);var s=new a;return s.once("finish",function(){if(t.complete=!0,t.emit("end"),clearTimeout(this._pending_refresh),s.getHeader("set-cookie")){var n=s.getHeader("set-cookie");Array.isArray(n)?n.forEach(function(t){document.cookie=t}):document.cookie=n}if(s.getHeader("refresh")){var i=s.getHeader("refresh").split(" url="),a=1e3*parseInt(i[0]),f=i[1];this._pending_refresh=setTimeout(this.navigate.bind(this,f),a)}if(s.getHeader("location"))return void setTimeout(this.navigate.bind(this,s.getHeader("location")),0);if(l=r,"GET"===t.method&&!e.popState){var p=t.url.match(c);if(null==p)window.scrollTo(0,0);else{var d=document.getElementById(p[1]);d&&d.scrollIntoView({block:"start",behavior:u.pathname===o.pathname&&(u.search||"")===(o.search||"")?"smooth":"auto"})}t.headers.referer!==t.url&&h.pushState(null,document.title,t.url)}}.bind(this)),this.emit("request",t,s),this},e.exports=r},{1:1,17:17,3:3,30:30,4:4}],6:[function(t,e){"use strict";var r=t(7),n=r.flat,o={INPUT:!0,TEXTAREA:!0,SELECT:!0,BUTTON:!0};e.exports=function(t,e){if(!t||"FORM"!==t.nodeName)throw new Error("Can only parse form elements.");for(var s,i=e?n:r,a="multipart/form-data"===t.enctype,h=t.elements,u={},c=a?{}:void 0,f=0,l=h.length;l>f;f++)if(s=h[f],!s.disabled&&s.name&&o[s.nodeName]){var p=s.name,d=s.options;switch(s.type){case"submit":s===document.activeElement&&i(u,p,s.value);break;case"checkbox":case"radio":s.checked&&i(u,p,s.value);break;case"select-one":s.selectedIndex>=0&&i(u,p,d[s.selectedIndex].value);break;case"select-multiple":for(var m,v=[],g=0,y=d.length;y>g;g++)m=d[g],m&&m.selected&&v.push(m.value);i(u,p,v);break;case"file":var b=s.files;if(a&&b)for(var w=0,x=b.length;x>w;w++)i(c,p,b[w]);break;default:i(u,p,s.value)}}return{body:u,files:c}}},{7:7}],7:[function(t,e){"use strict";function r(t,e,r){for(var n,o,s,u,c=""===e?[""]:e.match(i),f=c.length,l=t,p=0;f>p;p++)o=l,n=c[p],s=c[p+1],"[]"===n&&(n=l.length),l=(u="object"==typeof l&&n in l)?l[n]:l[n]="[]"===s||a.test(s)?[]:{};return o[n]=u?h.concat(l,r):r,t}function n(t,e,r){return e=o(t,e),t[e]=e in t?h.concat(t[e],r):r,t}function o(t,e){var r=e.split("[]");if(1===r.length)return e;for(var n=r[0],o=Object.keys(t),i=1,a=r.length;a>i;i++)n+="["+s(o,n)+"]"+r[i];return n}function s(t,e){for(var r,n=-1,o=t.length;o--;)r=t[o],0===r.indexOf(e)&&(r=r.replace(e,""),r=r.slice(1,r.indexOf("]")),r>n&&(n=Number(r)));return n+1}var i=/[^\[\]]+|\[\]/g,a=/^\d+$/,h=[];r.flat=n,e.exports=r},{}],8:[function(t,e){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],9:[function(t,e){"use strict";function r(t){if(!Array.isArray(t))throw new TypeError("Rill: Middleware stack must be an array.");var e=n(t,[]);return function(t,r){function n(s){if(o>=s)return Promise.reject(new Error("Rill: next() called multiple times."));var i=e[s]||r;if(o=s,!i)return Promise.resolve();try{return Promise.resolve(i(t,function(){return n(s+1)}))}catch(a){return Promise.reject(a)}}var o=-1;return n(0)}}function n(t,e){for(var r,o=t.length,s=0;o>s;s++)if(r=t[s])if("function"==typeof r)e.push(r);else if(Array.isArray(r))n(r,e);else{if(!Array.isArray(r.stack))throw new TypeError("Rill: Middleware must be an functions. Got a ["+r.constructor.name+"].");n(r.stack,e)}return e}e.exports=r},{}],10:[function(t,e,r){"use strict";var n=/ *([^=;]+) *=? *([^;]+)?/g;r.parse=function(t){if("string"!=typeof t)return{};for(var e,r,o,s={};e=n.exec(t);)r=e[1],o=e[2],s[r]=o?decodeURIComponent(o):void 0;return s},r.serialize=function(t,e,r){var n=[t+"="+encodeURIComponent(e)];return r&&(r.domain&&n.push("domain="+r.domain),r.path&&n.push("path="+r.path),r.expires&&n.push("expires="+(r.expires.toUTCString?r.expires.toUTCString():r.expires)),r.maxAge&&n.push("max-age="+(0|r.maxAge)),r.httpOnly&&n.push("httponly"),r.secure&&n.push("secure")),n.join("; ")}},{}],11:[function(t,e){"use strict";function r(t,e,n){if("number"!=typeof t)throw new TypeError("Rill#HttpError.fail: Status code must be a number.");this.name="HttpError",this.code=t,this.message=e||s[t];for(var o in n)this[o]=n[o];Error.captureStackTrace?Error.captureStackTrace(this,r):Error.call(this)}function n(t,e,n){throw new r(t,e,n)}function o(t,e,r,o){t||n(e,r,o)}var s=t(2).STATUS_CODES;r.prototype=new Error,r.fail=n,r.assert=o,e.exports=r},{2:2}],12:[function(t,e){"use strict";e.exports=t(2)},{2:2}],13:[function(t,e){"use strict";e.exports=function(t){var e,r;if(!t)return 0;for(t=t.toString(),e=r=t.length;e--;){var n=t[e].charCodeAt();n>=56320&&57343>=n&&e--,n>127&&2047>=n?r++:n>2047&&65535>=n&&(r+=2)}return r}},{}],14:[function(t,e){"use strict";e.exports={Buffer:function(){}}},{}],15:[function(t,e){"use strict";e.exports={lookup:function(){}}},{}],16:[function(t,e){"use strict";function r(t){return t instanceof i}function n(t){return"function"==typeof t.pipe}function o(t){if("function"==typeof t.toJSON||t.constructor===Object||t.constructor===Array)return!0;try{return JSON.stringify(t),!0}catch(e){return!1}}var s=/^\s*</,i=t(14).Buffer,a=t(15).lookup;e.exports=function(t){if(null!=t&&"function"!=typeof t){if("object"==typeof t){if(r(t))return"application/octet-stream";if(n(t))return a(t.path)||"application/octet-stream";if(o(t))return"application/json; charset=UTF-8"}return"text/"+(s.test(String(t))?"html":"plain")+"; charset=UTF-8"}}},{14:14,15:15}],17:[function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function i(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,o,a,h,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],i(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(s(r))for(a=Array.prototype.slice.call(arguments,1),u=r.slice(),o=u.length,h=0;o>h;h++)u[h].apply(this,a);return!0},r.prototype.addListener=function(t,e){var o;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(o=i(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,"function"==typeof console.trace)),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),o||(o=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var o=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,o,i,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],i=r.length,o=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(r)){for(a=i;a-->0;)if(r[a]===e||r[a].listener&&r[a].listener===e){o=a;break}if(0>o)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],18:[function(t,e){"use strict";function r(t){if("string"!=typeof t)throw new TypeError("Header Fields must be strings.");return t=t.toLowerCase(),"referrer"===t&&(t="referer"),t}e.exports=r},{}],19:[function(t,e){(function(t){"use strict";function r(){}function n(t){var e=t.toLowerCase();return function(t){var r=typeof t;switch(r){case"object":case"function":return o.call(t)===i[e];default:return r===e}}}var o=Object.prototype.toString,s=t.Buffer||r,i={string:"[object String]",number:"[object Number]","boolean":"[object Boolean]",date:"[object Date]",regexp:"[object RegExp]",error:"[object Error]","function":"[object Function]",arguments:"[object Arguments]",object:"[object Object]",array:"[object Array]"};e.exports={string:n("String"),number:n("Number"),"boolean":n("Boolean"),date:n("Date"),regexp:n("RegExp"),error:n("Error"),"function":n("Function"),arguments:n("Arguments"),object:n("Object"),array:n("Array"),stream:function(t){return null!=t&&"function"==typeof t.pipe},buffer:function(t){return t instanceof s},empty:function(t){for(var e in t)return!1;return!0}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(t,e){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],21:[function(t,e){function r(t,e){for(var r,n=[],o=0,s=0,i="",u=e&&e.delimiter||"/";null!=(r=g.exec(t));){var c=r[0],f=r[1],l=r.index;if(i+=t.slice(s,l),s=l+c.length,f)i+=f[1];else{var p=t[s],d=r[2],m=r[3],v=r[4],y=r[5],b=r[6],w=r[7];i&&(n.push(i),i="");var x=null!=d&&null!=p&&p!==d,E="+"===b||"*"===b,T="?"===b||"*"===b,C=r[2]||u,A=v||y;n.push({name:m||o++,prefix:d||"",delimiter:C,optional:T,repeat:E,partial:x,asterisk:!!w,pattern:A?h(A):w?".*":"[^"+a(C)+"]+?"})}}return s<t.length&&(i+=t.substr(s)),i&&n.push(i),n}function n(t,e){return i(r(t,e))}function o(t){return encodeURI(t).replace(/[\/?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function s(t){return encodeURI(t).replace(/[?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function i(t){for(var e=new Array(t.length),r=0;r<t.length;r++)"object"==typeof t[r]&&(e[r]=new RegExp("^(?:"+t[r].pattern+")$"));return function(r,n){for(var i="",a=r||{},h=n||{},u=h.pretty?o:encodeURIComponent,c=0;c<t.length;c++){var f=t[c];if("string"!=typeof f){var l,p=a[f.name];if(null==p){if(f.optional){f.partial&&(i+=f.prefix);continue}throw new TypeError('Expected "'+f.name+'" to be defined')}if(v(p)){if(!f.repeat)throw new TypeError('Expected "'+f.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(f.optional)continue;throw new TypeError('Expected "'+f.name+'" to not be empty')}for(var d=0;d<p.length;d++){if(l=u(p[d]),!e[c].test(l))throw new TypeError('Expected all "'+f.name+'" to match "'+f.pattern+'", but received `'+JSON.stringify(l)+"`");i+=(0===d?f.prefix:f.delimiter)+l}}else{if(l=f.asterisk?s(p):u(p),!e[c].test(l))throw new TypeError('Expected "'+f.name+'" to match "'+f.pattern+'", but received "'+l+'"');i+=f.prefix+l}}else i+=f}return i}}function a(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function h(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function u(t,e){return t.keys=e,t}function c(t){return t.sensitive?"":"i"}function f(t,e){var r=t.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)e.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(t,e)}function l(t,e,r){for(var n=[],o=0;o<t.length;o++)n.push(m(t[o],e,r).source);var s=new RegExp("(?:"+n.join("|")+")",c(r));return u(s,e)}function p(t,e,n){return d(r(t,n),e,n)}function d(t,e,r){v(e)||(r=e||r,e=[]),r=r||{};for(var n=r.strict,o=r.end!==!1,s="",i=0;i<t.length;i++){var h=t[i];if("string"==typeof h)s+=a(h);else{var f=a(h.prefix),l="(?:"+h.pattern+")";e.push(h),h.repeat&&(l+="(?:"+f+l+")*"),l=h.optional?h.partial?f+"("+l+")?":"(?:"+f+"("+l+"))?":f+"("+l+")",s+=l}}var p=a(r.delimiter||"/"),d=s.slice(-p.length)===p;return n||(s=(d?s.slice(0,-p.length):s)+"(?:"+p+"(?=$))?"),s+=o?"$":n&&d?"":"(?="+p+"|$)",u(new RegExp("^"+s,c(r)),e)}function m(t,e,r){return v(e)||(r=e||r,e=[]),r=r||{},t instanceof RegExp?f(t,e):v(t)?l(t,e,r):p(t,e,r)}var v=t(20);e.exports=m,e.exports.parse=r,e.exports.compile=n,e.exports.tokensToFunction=i,e.exports.tokensToRegExp=d;var g=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{20:20}],22:[function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function s(t){if(f===clearTimeout)return clearTimeout(t);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function i(){m&&p&&(m=!1,p.length?d=p.concat(d):v=-1,d.length&&a())}function a(){if(!m){var t=o(i);m=!0;for(var e=d.length;e;){for(p=d,d=[];++v<e;)p&&p[v].run();v=-1,e=d.length}p=null,m=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function u(){}var c,f,l=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(t){c=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(t){f=n}}();var p,d=[],m=!1,v=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new h(t,e)),1!==d.length||m||o(a)},h.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.binding=function(){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],23:[function(e,r,n){(function(e){!function(o){function s(t){throw new RangeError(U[t])}function i(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function a(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(q,".");var o=t.split("."),s=i(o,e).join(".");return n+s}function h(t){for(var e,r,n=[],o=0,s=t.length;s>o;)e=t.charCodeAt(o++),e>=55296&&56319>=e&&s>o?(r=t.charCodeAt(o++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--)):n.push(e);return n}function u(t){return i(t,function(t){var e="";return t>65535&&(t-=65536,e+=P(t>>>10&1023|55296),t=56320|1023&t),e+=P(t)}).join("")}function c(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:T}function f(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function l(t,e,r){var n=0;for(t=r?I(t/j):t>>1,t+=I(t/e);t>N*A>>1;n+=T)t=I(t/N);return I(n+(N+1)*t/(t+_))}function p(t){var e,r,n,o,i,a,h,f,p,d,m=[],v=t.length,g=0,y=O,b=S;for(r=t.lastIndexOf(R),0>r&&(r=0),n=0;r>n;++n)t.charCodeAt(n)>=128&&s("not-basic"),m.push(t.charCodeAt(n));for(o=r>0?r+1:0;v>o;){for(i=g,a=1,h=T;o>=v&&s("invalid-input"),f=c(t.charCodeAt(o++)),(f>=T||f>I((E-g)/a))&&s("overflow"),g+=f*a,p=b>=h?C:h>=b+A?A:h-b,!(p>f);h+=T)d=T-p,a>I(E/d)&&s("overflow"),a*=d;e=m.length+1,b=l(g-i,e,0==i),I(g/e)>E-y&&s("overflow"),y+=I(g/e),g%=e,m.splice(g++,0,y)}return u(m)}function d(t){var e,r,n,o,i,a,u,c,p,d,m,v,g,y,b,w=[];for(t=h(t),v=t.length,e=O,r=0,i=S,a=0;v>a;++a)m=t[a],128>m&&w.push(P(m));for(n=o=w.length,o&&w.push(R);v>n;){for(u=E,a=0;v>a;++a)m=t[a],m>=e&&u>m&&(u=m);for(g=n+1,u-e>I((E-r)/g)&&s("overflow"),r+=(u-e)*g,e=u,a=0;v>a;++a)if(m=t[a],e>m&&++r>E&&s("overflow"),m==e){for(c=r,p=T;d=i>=p?C:p>=i+A?A:p-i,!(d>c);p+=T)b=c-d,y=T-d,w.push(P(f(d+b%y,0))),c=I(b/y);w.push(P(f(c,0))),i=l(r,g,n==o),r=0,++n}++r,++e}return w.join("")}function m(t){return a(t,function(t){return k.test(t)?p(t.slice(4).toLowerCase()):t})}function v(t){return a(t,function(t){return L.test(t)?"xn--"+d(t):t})}var g="object"==typeof n&&n&&!n.nodeType&&n,y="object"==typeof r&&r&&!r.nodeType&&r,b="object"==typeof e&&e;(b.global===b||b.window===b||b.self===b)&&(o=b);var w,x,E=2147483647,T=36,C=1,A=26,_=38,j=700,S=72,O=128,R="-",k=/^xn--/,L=/[^\x20-\x7E]/,q=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=T-C,I=Math.floor,P=String.fromCharCode;if(w={version:"1.4.1",ucs2:{decode:h,encode:u},decode:p,encode:d,toASCII:v,toUnicode:m},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",function(){return w});else if(g&&y)if(r.exports==g)y.exports=w;else for(x in w)w.hasOwnProperty(x)&&(g[x]=w[x]);else o.punycode=w}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],24:[function(t,e,r){arguments[4][7][0].apply(r,arguments)},{7:7}],25:[function(t,e){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,o,s){e=e||"&",o=o||"=";var i={};if("string"!=typeof t||0===t.length)return i;var a=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var u=t.length;h>0&&u>h&&(u=h);for(var c=0;u>c;++c){var f,l,p,d,m=t[c].replace(a,"%20"),v=m.indexOf(o);v>=0?(f=m.substr(0,v),l=m.substr(v+1)):(f=m,l=""),p=decodeURIComponent(f),d=decodeURIComponent(l),r(i,p)?n(i[p])?i[p].push(d):i[p]=[i[p],d]:i[p]=d}return i};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],26:[function(t,e){"use strict";function r(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?r(s(t),function(s){var a=encodeURIComponent(n(s))+i;return o(t[s])?r(t[s],function(t){return a+encodeURIComponent(n(t))}).join(e):a+encodeURIComponent(n(t[s]))}).join(e):a?encodeURIComponent(n(a))+i+encodeURIComponent(n(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},{}],27:[function(t,e,r){"use strict";r.decode=r.parse=t(25),r.encode=r.stringify=t(26)},{25:25,26:26}],28:[function(t,e,r){arguments[4][8][0].apply(r,arguments)},{8:8}],29:[function(t,e){"use strict";function r(t,e){var r=[];return Object.keys(e).forEach(function(n){var o=e[n],s=Number(n);t[s]=o,t[o]=s,t[o.toLowerCase()]=s,r.push(s)}),r}function n(t){if("number"==typeof t){if(!n[t])throw new Error("invalid status code: "+t);return t}if("string"!=typeof t)throw new TypeError("code must be a number or string");var e=parseInt(t,10);if(!isNaN(e)){if(!n[e])throw new Error("invalid status code: "+e);return e}if(e=n[t.toLowerCase()],!e)throw new Error('invalid status message: "'+t+'"');return e}var o=t(28);e.exports=n,n.codes=r(n,o),n.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},n.empty={204:!0,205:!0,304:!0},n.retry={502:!0,503:!0,504:!0}},{28:28}],30:[function(t,e,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,r){if(t&&u.isObject(t)&&t instanceof n)return t;var o=new n;return o.parse(t,e,r),o}function s(t){return u.isString(t)&&(t=o(t)),t instanceof n?t.format():n.prototype.format.call(t)}function i(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var h=t(23),u=t(31);r.parse=o,r.resolve=i,r.resolveObject=a,r.format=s,r.Url=n;var c=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","	"],d=["{","}","|","\\","^","`"].concat(p),m=["'"].concat(d),v=["%","/","?",";","#"].concat(m),g=["/","?","#"],y=255,b=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=t(27);n.prototype.parse=function(t,e,r){if(!u.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=-1!==n&&n<t.indexOf("#")?"?":"#",s=t.split(o),i=/\\/g;s[0]=s[0].replace(i,"/"),t=s.join(o);var a=t;if(a=a.trim(),!r&&1===t.split("#").length){var f=l.exec(a);if(f)return this.path=a,this.href=a,this.pathname=f[1],f[2]?(this.search=f[2],this.query=e?C.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=c.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(r||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===a.substr(0,2);!A||p&&E[p]||(a=a.substr(2),this.slashes=!0)}if(!E[p]&&(A||p&&!T[p])){for(var _=-1,j=0;j<g.length;j++){var S=a.indexOf(g[j]);-1!==S&&(-1===_||_>S)&&(_=S)}var O,R;R=-1===_?a.lastIndexOf("@"):a.lastIndexOf("@",_),-1!==R&&(O=a.slice(0,R),a=a.slice(R+1),this.auth=decodeURIComponent(O)),_=-1;for(var j=0;j<v.length;j++){var S=a.indexOf(v[j]);-1!==S&&(-1===_||_>S)&&(_=S)}-1===_&&(_=a.length),this.host=a.slice(0,_),a=a.slice(_),this.parseHost(),this.hostname=this.hostname||"";var k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k)for(var L=this.hostname.split(/\./),j=0,q=L.length;q>j;j++){var U=L[j];if(U&&!U.match(b)){for(var N="",I=0,P=U.length;P>I;I++)N+=U.charCodeAt(I)>127?"x":U[I];if(!N.match(b)){var H=L.slice(0,j),M=L.slice(j+1),F=U.match(w);F&&(H.push(F[1]),M.unshift(F[2])),M.length&&(a="/"+M.join(".")+a),this.hostname=H.join(".");break}}}this.hostname=this.hostname.length>y?"":this.hostname.toLowerCase(),k||(this.hostname=h.toASCII(this.hostname));var D=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+D,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!x[d])for(var j=0,q=m.length;q>j;j++){var B=m[j];if(-1!==a.indexOf(B)){var K=encodeURIComponent(B);K===B&&(K=escape(B)),a=a.split(B).join(K)}}var G=a.indexOf("#");-1!==G&&(this.hash=a.substr(G),a=a.slice(0,G));var V=a.indexOf("?");if(-1!==V?(this.search=a.substr(V),this.query=a.substr(V+1),e&&(this.query=C.parse(this.query)),a=a.slice(0,V)):e&&(this.search="",this.query={}),a&&(this.pathname=a),T[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var D=this.pathname||"",z=this.search||"";this.path=D+z}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(s=C.stringify(this.query));var i=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||T[e])&&o!==!1?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),i&&"?"!==i.charAt(0)&&(i="?"+i),r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),i=i.replace("#","%23"),e+o+r+i+n},n.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(u.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var r=new n,o=Object.keys(this),s=0;s<o.length;s++){var i=o[s];r[i]=this[i]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),h=0;h<a.length;h++){var c=a[h];"protocol"!==c&&(r[c]=t[c])}return T[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!T[t.protocol]){for(var f=Object.keys(t),l=0;l<f.length;l++){var p=f[l];r[p]=t[p]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||E[t.protocol])r.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),
d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var m=r.pathname||"",v=r.search||"";r.path=m+v}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=y||g||r.host&&t.pathname,w=b,x=r.pathname&&r.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],C=r.protocol&&!T[r.protocol];if(C&&(r.hostname="",r.port=null,r.host&&(""===x[0]?x[0]=r.host:x.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),b=b&&(""===d[0]||""===x[0])),y)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,x=d;else if(d.length)x||(x=[]),x.pop(),x=x.concat(d),r.search=t.search,r.query=t.query;else if(!u.isNullOrUndefined(t.search)){if(C){r.hostname=r.host=x.shift();var A=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;A&&(r.auth=A.shift(),r.host=r.hostname=A.shift())}return r.search=t.search,r.query=t.query,u.isNull(r.pathname)&&u.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!x.length)return r.pathname=null,r.path=r.search?"/"+r.search:null,r.href=r.format(),r;for(var _=x.slice(-1)[0],j=(r.host||t.host||x.length>1)&&("."===_||".."===_)||""===_,S=0,O=x.length;O>=0;O--)_=x[O],"."===_?x.splice(O,1):".."===_?(x.splice(O,1),S++):S&&(x.splice(O,1),S--);if(!b&&!w)for(;S--;S)x.unshift("..");!b||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),j&&"/"!==x.join("/").substr(-1)&&x.push("");var R=""===x[0]||x[0]&&"/"===x[0].charAt(0);if(C){r.hostname=r.host=R?"":x.length?x.shift():"";var A=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;A&&(r.auth=A.shift(),r.host=r.hostname=A.shift())}return b=b||r.host&&x.length,b&&!R&&x.unshift(""),x.length?r.pathname=x.join("/"):(r.pathname=null,r.path=null),u.isNull(r.pathname)&&u.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=f.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{23:23,27:27,31:31}],31:[function(t,e){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],32:[function(t,e){"use strict";function r(t,e){this.req=new o(this,t),this.res=new s(this,e),this.fail=this.fail.bind(this),this.assert=this.assert.bind(this),this.locals={}}var n=t(11),o=t(34),s=t(36);e.exports=r;var i=r.prototype;i.fail=function(t,e,r){if("number"!=typeof t)throw new TypeError("Rill#ctx.fail: Status code must be a number.");var o=new n(t,e,r);throw this.res.status=o.code,this.res.message=o.message,o},i.assert=function(t,e,r,n){if("number"!=typeof e)throw new TypeError("Rill#ctx.assert: Status code must be a number.");t||this.fail(e,r,n)}},{11:11,34:34,36:36}],33:[function(t,e){(function(r){"use strict";function n(){return this instanceof n?void(this.stack=[]):new n}function o(t,e,r){var n=p(t),o=n[n.length-1];o&&o.asterisk&&(o.optional=!0);var s=d(n,r);s.keys=e;for(var i=0,a=n.length;a>i;i++)"object"==typeof n[i]&&e.push(n[i]);return s}var s=t(21),i=t(2),a=t(12),h=t(9),u=t(11),c=t(32),f=t(35),l=r.browser&&t.resolve("@rill/http/adapter/browser"),p=s.parse,d=s.tokensToRegExp,m=Array.prototype.slice,v=n.prototype;e.exports=n["default"]=n,v.listen=function(t,e){"function"==typeof t&&(e=t,t=null),t=t||{},t.port=null!=t.port?t.port:0;var n=t.tls?a.createServer(t.tls,this.handler()):i.createServer(this.handler());return r.browser&&l(n),n.listen(t.port,t.ip,t.backlog,e)},v.handler=function(){var t=h(this.stack);return function(e,r){function n(t){404===Number(s.res.status)&&(s.res.status=500),t instanceof u||console&&console.error&&void 0}function o(){f(s)}r.statusCode=404;var s=new c(e,r);t(s)["catch"](n).then(o)}},v.use=function(){for(var t=this.stack.length,e=this.stack.length+=arguments.length,r=e;t<r--;)this.stack[r]=arguments[r-t];return this},v.setup=function(){for(var t,e=arguments.length,r=0;e>r;r++)if(t=arguments[r]){if("function"!=typeof t)throw new TypeError("Rill#setup: Setup must be a function or falsey.");t(this)}return this},v.at=function(t){if("string"!=typeof t)throw new TypeError("Rill#at: Path name must be a string.");var e=[],r=o(t,e,{end:!1,delimiter:"/"}),n=h(m.call(arguments,1));return this.use(function(t,o){var s=t.req.matchPath,i=s.match(r);if(!i||i[0]!==s)return o();for(var a,h,u=e.length;u--;)a=e[u],h=i[u+1],a.repeat&&(h=null==h?[]:h.split("/")),t.req.params[a.name]=h;var c=i[i.length-1]||"";return t.req.matchPath!==c&&(t.req.matchPath="/"+c),n(t,function(){return t.req.matchPath=s,o()})})},v.host=function(t){if("string"!=typeof t)throw new TypeError("Rill#host: Host name must be a string.");var e=[],r=o(t,e,{strict:!0,delimiter:"."}),n=h(m.call(arguments,1));return this.use(function(t,o){var s=t.req.matchHost,i=s.match(r);if(!i||i[0]!==s)return o();for(var a,h,u=e.length;u--;)a=e[u],h=i[u+1],a.repeat&&(h=null==h?[]:h.split(".")),t.req.subdomains[a.name]=h;var c=i[i.length-1]||"";return t.req.matchHost!==c&&(t.req.matchHost=c),n(t,function(){return t.req.matchHost=s,o()})})},i.METHODS.forEach(function(t){var e=t.toLowerCase();v[e]=function(e){function r(e,r){return e.req.method!==t?r():o(e,r)}var n="string"==typeof e?1:0,o=h(m.call(arguments,n));return 1===n?this.at(e,r):this.use(r)}})}).call(this,t(22))},{11:11,12:12,2:2,21:21,22:22,32:32,35:35,9:9}],34:[function(t,e){(function(r){"use strict";function n(t,e){var n=e.connection.encrypted?"https":"http",a=r.browser?e._request.parsed:o.parse(n+"://"+e.headers.host+e.url),u=n+"://"+a.host;this.ctx=t,this.original=e,this.method=e.method,this.headers=e.headers,this.cookies=h.parse(this.headers.cookie),this.params={},this.href=a.href,this.protocol=n,this.port=a.port,this.host=a.host,this.hostname=this.matchHost=a.hostname,this.path=a.path,this.pathname=this.matchPath=a.pathname,this.search=a.search,this.hash=a.hash,this.query={},this.origin=u,this.secure="https"===n,this.subdomains=String(this.hostname).split(".").reverse().slice(2),this.ip=e.connection.remoteAddress||e.socket.remoteAddress||e.connection.socket&&e.connection.socket.remoteAddress;var c=a.query=s.parse(a.query);for(var f in c)i(this.query,f,c[f])}var o=t(30),s=t(27),i=t(24),a=t(18),h=t(10);e.exports=n;var u=n.prototype;u.get=function(t){return this.headers[a(t)]}}).call(this,t(22))},{10:10,18:18,22:22,24:24,27:27,30:30}],35:[function(t,e){"use strict";function r(t){var e=t.req,r=t.res,h=r.body,u=r.original,c=a.stream(h),f=a.buffer(h);r.respond!==!1&&(u.headersSent||(404===Number(r.status)&&(r.get("Location")?r.status=302:h&&(r.status=200)),r.message=r.message||i[r.status],"HEAD"===e.method||i.empty[r.status]||!h?(h=null,r.remove("Content-Type"),r.remove("Content-Length")):(r.get("Content-Type")||r.set("Content-Type",s(h)),"object"!=typeof h||c||f||(h=JSON.stringify(h)),r.get("Content-Length")||c||r.set("Content-Length",o(h))),u.writeHead(r.status,r.message,n(r.headers)),r.end!==!1&&(c?h.pipe(u):u.end(h))))}function n(t){for(var e in t)(null==t[e]||0===t[e].length)&&delete t[e];return t}var o=t(13),s=t(16),i=t(29),a=t(19);e.exports=r},{13:13,16:16,19:19,29:29}],36:[function(t,e){"use strict";function r(t,e){this.ctx=t,this.original=e,this.status=e.statusCode,this.body=void 0,this.headers={},e.once("finish",function(){t.res.finished=!0})}var n=t(30),o=t(29),s=t(18),i=t(10);e.exports=r;var a=r.prototype;a.cookie=function(t,e,r){this.append("Set-Cookie",i.serialize(t,e,r))},a.clearCookie=function(t,e){e=e||{},e.expires=new Date,this.append("Set-Cookie",i.serialize(t,"",e))},a.redirect=function(t,e){var r=this.ctx.req;if(t="back"===t?r.get("Referrer"):t,t=t||e,!t)throw new TypeError("Rill#ctx.res.redirect: Cannot redirect, url not specified and alternative not provided.");o.redirect[this.status]||(this.status=302),this.set("Location",n.resolve(r.href,t))},a.refresh=function(t,e,r){var o=this.ctx.req;t=t||0,e="back"===e?o.get("Referrer"):e,e=e||r||o.href,this.set("Refresh",t+"; url="+n.resolve(o.href,e))},a.get=function(t){return this.headers[s(t)]},a.set=function(t,e){this.headers[s(t)]=e},a.append=function(t,e){t=s(t);var r=this.headers,n=this.headers[t];null==n?n=[]:Array.isArray(n)||(n=[n]),r[t]=n.concat(e)},a.remove=function(t){delete this.headers[s(t)]}},{10:10,18:18,29:29,30:30}]},{},[33])(33)});